<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Statistics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Statistics</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code></pre></div>
<div id="theoretical-densities" class="section level1">
<h1>Theoretical densities</h1>
<p>One of the more useful tools for inspecting your data is to view the
density of datapoints. There are great ways of doing this, such as
histograms and kernel density estimates (KDEs). However, sometimes you
might wonder how the density of your data compares to the density of a
theoretical distribution, such as a normal or Poisson distribution. The
<code>stat_theodensity()</code> function estimates the necessary
parameters for a range of distributions and calculates the probability
density for continuous distributions or probability mass for discrete
distributions. The function uses maximum likelihood procedures through
the <strong>fitdistrplus</strong> package.</p>
<div id="continuous-distributions" class="section level2">
<h2>Continuous distributions</h2>
<p>Plotting continuous distributions is straightforward enough. You just
tell <code>stat_theodensity()</code> what distribution youâ€™d like to
fit. It automatically performs the fitting for groups separately, as
shown in the example below where we artificially split up the faithful
data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>We can compare this to kernel density estimates, which are more
empirical.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Theoretical&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Kernel Estimates&quot;</span>), </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAA9lBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYAv8QzMzM6AAA6ADo6AGY6OgA6OmY6OpA6ZrY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmZgBmkJBmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQZgCQkDqQkGaQtpCQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zjq225C22/+2/7a2/9u2///Ijk3I///bkDrb25Db/7bb///kq27k///r6+v4dm3/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///8AghFGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAART0lEQVR4nO2dD3/ctBnHndDFJNm6pINQBjvYgG2kIxywNSuQcqOtfD2SJn7/b2Z+JNmWbP2zLVm27/l9epc7RVaq52s9kq3HUpKjoiqJ/R/YdyGAyEIAkYUAIgsBRBYCiKzuAAgh8FJInewhc/8iAljMsxBAZCGAyEIAkYUAIgsBRBYCiCwEEFkIILIQQGQhgMjyAyANYj0PRQSwmGd5AZAyAgighxBAZCGAyPIxH5DSf6he8tECUoItoLc8AaAvBNBDCCCyEEBkIYDIQgCRhQAiyxcAeEMAPeQBQFq+I4AeQgCRhQAiCwFEFgKILAQQWQggshBAZHkDUPxAAD2EACILAUQWAois4QDS6icC6CGfANKUKIQAjMIWEFl+AaiaAAIwCgFE1n66oLuL5ODb05vd6TfJ4c39ZZIc5fnuZE3fdidXSfLo1TCzussI4Pavv9Cfr8/Pz//0C09s1rEchVIAiiYwQQB3F2fF6/Bmd1wY/v7yiL4qAMfA5MinkU0yAXhbWv3l10Jqs45SC5gHgO3hTZ5vAMCKfyneagAr3hxGkQHAyyf/Zi3g4fvnQnKzjjN0QRvwMLtTZvMt/QKuZ13/vLtYeTSySS4u6N1XhQuijeD9Qs1MafljPhHScwNw+/lzoRU0T7LqbnSaE5UPmmALkLzO9mCtcEGnN17NrJdTJwyq+oFmHSuTzwdA1QmDzctOGBLvLw+m1An3AeDTeh6K0FQMhqFXHEDOh6H57jhJ/vIRG4aOZn8nAG8/eJM//GAehqazAgDaasb64w2AqKwA4FVcBzypBkLNOs6xDyjcvtbLTAmAUs06ztEFbRK9l0EAPosIYDHP8gSARqjn1Vc/1vNQRACLeRYCiCyPLkh5MxoBWOQfQBMDAjDKowuaDwB1cXFoDQZgMP1Q63koQlsF5ZEx5AdA66MX63koQlsF5ZEx5B8AuqBO8u+CEEAnYR9gyxxY2AfYMgeWTwB52kgYaD0PRWiroDwyhny6oHwusaHq4hBAx9RQANh8MMzZVxPDAaeI/bugpg+aL4D6gKkD4CZfGgD4cHeRvPfn9e70kyQJE6gSAIA363koQleFrCWiBnB9BhOYu+Mz7RzyQAVwQd6s56EIbRWURzJBdEShQwBw9/Qmv3+2BhSB3BD2Aa3MYgvYPX41BwDL7QNm0gLm1weoj2RS9QETB1BVfSZPyKiL042CfjexFtBQ2v4y+TBpM4CmwgbqenVByruis2sBoiBu9CBooNZQAIL9l+KCxpUPAHXVEUBnhQCwIBcUXuiCbJkDCwHYMgdWkD5A4oAAjEIAtsyBhS7IljmwPACorJ7P5Ul5dXGzBSBWXTEORQBGIQBb5sBCF2TLHFgIoJV5vGUKQEFcUDO1p/U8FKGtgvJIJgTgmBoawN0FXU5rRZ8cDhQTsbcuKG2JtABc01CUzVm+SVZ58SOMPAOYx1IF6uIaAGA+/u6j9e7xq/9eHd0/CzUr49kFKcahcwUAPwq73z396emL05+ehuoXEEArs9wC8utP/3j/7CrY+jUigLsLl+lP0gBQG3tZLoj3Afk2Yb1AIMkt4NphxUypjmIXsBgANDTxiI2C2OopdI2zMGq6oOKvJuYOnzQAyFVfgAsaV+0+ACIxTMCJEYD4wMZQ63koQlsF5ZEx1ASwoSsZXRscETG6oFmslqIubgIA4OSnvY3J5xEE4FPyKKhh93LVxHdfnX/wpkwkDi5Ijhjtaz0PRagrrS5uCgDk079cO/rhu6/z1x+Wucj8AUxJBgDV2tHv/vGLsIQoMbugOTwnPCXVADZJqeqqr1y6+Is3+bu/w7qVrbWj03Ys9ORjo6clRQuoJSzcygCAiNkFtcah2AKMclq8+wsEEEwVgOL0h6tg9nwgT7vFPiC4XFrAw3df6kdB7XN9+g/pTUlOa0d3uQ5o+SC/AOgT1e5FhDfgUEkAmBuy3PkjEQFk1ZtjEUFt50USgOsj2NpmY558IOiCfKoxDIVF3S03v4kNQLAnZKpTnzWEbIkAYB+PbgAUVU9JuD6AKqN9gdgd6DIHtp4HiQDuL89ga4PrTi5IUfXgAHhfnCsJzBgATMYdGecCQMTqgsIH57KTP1e2gTkDcFLD0qMBEI3NARAEoK665IPC9AE8WUFgzgCqpYpMRzQtrap6M16ut6mVqVmdvCwAbtuXEQmAevo9wKR8beqsvBxbHAC3DRTjABD626x8l7ksAACEYttFIrugGsXiALgFgBEHAGLT8A5ASl4UgNZ8gFLEwQV5n5BpOiD6oTU6bRcR2HoeNHQYOhKASq3b0fsOQFN1oRPw2gKka1+WuUlg1gA2SbLadLgVob/vmXoFUNlduhxeHoDrR7+yO9ImERcXFGpCJmsnLwgAvR296nI7OtXe9Qk4I9ZI3m8A2qp7dUEqB1R/baTOGEC+ARcEczImEScAdePw1wKad5/LZEMRQW3nRXInvIXLAMsTscTJBYW4ENM4myUBcBEZHYBmuFPOiO01AH3V/bsg7SWXqmsuv0xeQmhiFR3t/kigIRI69RclnQnv+t/PVHInDKa33ZQmbi7I4ygoU99zqC6QO7eA3ckaHj5t6rcf+9uxt0xPyKhFRgegue3Z3wWprK9LDa2BAAzWK+EMBpDZAMi/mzGA0gV5uQ7wDEAT/6DwQc4uaHfy7TF9KpQ9GQ0T4mc0JmpztDu5YmsG2B6aHi7FdYBlWoy4AjBauqsLCgHguDDxBtZkOoJr0FflmgT3l6vdMUsuf+XJ2CoFG4aOA4CrfZO6/KJUCWBFP2750AMAgBeGzUsavxpoZJMGAZDt37SeJxeUifMBmsz9AIDPL97404ln9PvmCP7Rj4Xhy18NNLJJcwfQ9kHdAXAXw76f/sxXiaMAgnofqmEATC7IFwASugVs+SpJ9Pv95aewYxJ1Qac327D7x4AmDwBsqw6DFjM3Z4qrL0rJAO4vYVmmgzXz9Rt4TLruhNmvhtnYqJAuKDVY2huAlg/qDKDaKuma2Z72v1fsefWJ76I0BgCa6rkFmEQXLBvxmiygCyI+AGTVmzGzPwB0gVAEIFvWCKCZYxAAenE2IwBm63lzQfYW0AhYrL9MXnMAoHkcEgFMBEDDByGASqyLGASAGRcBiCLOAMhwAMzCLkVkytQAFvOsGQDIbEXITcABgLq4+Iv2uYkgAJ+aNgBuWt8uSF0cAlCnZvYipCawRwDSZgWaNfLSAhBAQ3Ud09AtoDSsUxH7CMBmU7Y1jov19KmZSxG8pbSL0FZBWV4MGQDUK8W9Pj/nqxjnnQAQBGCVHoCwYvTLr4V0MkEAVc5mqrpq6uKkLUzuLvQParE9TtjCGtVsDcRSqHaAs20LpwdQrxb68P1zIZ2MBqA6r+1FCE3ACwDjogEcgGxZnaH7A6jXyy180fk5bQTy2tH2+OfhEdKOkc+Ze9bcAQCzP1tBcveHjw9fPP4XDVjjKTKALQTPwW9eFAc+u0qSsy2NZIEmwlah5EtRblVRdnoA9YrRt58/F1oBmWILKLM3U3UAkpaIAOBndv5fn9EYoeNV8WI7KvEUCQBsd8USKTk4gH6DLbC4X2KH8YzOAOQVo+t+gEwVACcw3AWd/J5OyIMFC6OBBflLSCn7gEevIDEv+wDYcQ9ePJFl5ofxNGcA8orRMQCobarOXHcCwwEcn9EAZfrIysFaBFCnCC6oIHGwVgG4pjG/1WE8ozOAesVocEYPP7SGoc3rMJWd0gEANDbtlLkXALD2CT1pq68cQJ0i966Fe2oBKMNMq8N4RmcA/DoAGkFxHfCk8kWkQwsYD0B5gK9h6IZ5fGbZCkKdUgOgu+0pAHCO9WE8ozsAjchYAIi6X9VkVncYvQFATFzhOphvqV51SrXA3op5muIANgqqXdAmSd77eFWk37DDeEZ/AEK7IBIJwLgaAsDBpgMA6K6tDEUggJaGAVDe3tEVkSEAVcXSwbejtXkRgItNewPQ3uA0FdG6c6etgrK8GOoPoNUHewegnuY1FbFXAMK7oI4AMgSgqFSa9gMgeiAEIIl0c0H9AWiiDU1FIICWBrigzgCy9gy+tgrK8mIotAsiPVsAQQA6kZEAZMpUSxEIoKV+ALJeALK9AtCyv98WkClTzUVkrUBSbRWU5cVQeADtfAajDgNAfACAR4NhrvF/lnAGRRyKLQJCpWkCyOTn8joMQ720APassB2AQ5JVU3VBUwDwiRCKIsSo3FShJi/qORq69NOCAKhW6XYrInMCAGEozVcTgBSKUs5GwkIGVXAKjyDaPvq1DkGZHABFPkNmltrwQJ2GoW4A1OXJAKRQFJhY5xO9dXCKZPMqXmUBAJpPZkcFUIei3D9b84lhngL/HrNZ9jIEZRkANKt0OxXhHQCLKRFbQBWcUrWAOgRlRACuNtUMgwwAWnt0dvp7cu8xGAB3/mJESvWR9wG70xd1CMoiALjlVV8HZL4B8JgSIS6XpbA4FP6FhaCMA6CzuoZIZ8PWgnY42gZgTIVvAXnXFtBqAKO7oDE1BgAlAS0AxS7NCEBUV4N0BNA2f1cA0l0kXRWU5cXQ1FxQ8xrMkFdfhPBFVwXlkTE0AgD1lYD29EUAFnU2iHogqr6KUjmgzgDEqZzJa1IAMs3KQB3/HgJopjoCyHTronQFIEznT16TAkA0S7R2/XsIoJGq8kGq2RTLPVLnvyfsej55TQdAO7bcUjACcDaIygc1MzOj+RgFicUEsJhnjQTAOnmQmZ6HRACi+hjEPntjfBoMAYjqYxBrGF3pgBCAXX0MQioCKaiVueo1PQGov0xe4wEAuzPjt1cyy8p3BGBXb4OU5357DY+s+oEA7OprEKEXABBCZvHWQYeCEUA3g4jdcANA/Y4A7BpkkFLik0v2OGgEIKq/QSQnVCVnCKCb+htEckJlciY4IATgokEGqcVpNObAEIBdQwySNj/K5z8CcNEggwjJadv8CEBSvXZ0/SkfCqC6L5qnqeIONAKoVa8dLawinXtoAYAgK8RYuDwLs58A6nVD5RVEBxkEBMan9z3TohH0K8I58yg2HCSXlXPrT+La0VlvsQDo4lIgT0NpBMt5ksva0fUn0KAzsl9mbAEIIJgi9AHdM+8ngHrt6PoTqKwjnV8hsutVpbDM5egzFbaYFHrgjEblZmy1B/aW0ZfwJn0QJSayQ+vl/iYvp7WjldcBCMCLBj2migCGCwFEFgKILAQQWQggsnw+qP2+PUu/zMEKnoAQQGQhgMhCAJE1wmIdKJMQQGQhgMhCAJGFACLLG4Dbz/iewy56K2yRbhdEZThK2nx9FvIFAKYsYd9hJ9H9KT+05+N67U72pXPOqcgXgLdgzy7VF3bKteX82z9dy5U3X5+FfPYBwvbPdjm3gIfv/+PsgurN12cjjwBg6thVt589cYX1+kv3PkDefH0W8gfg3Vfu9s/dm8vtF286dMKgefUDHkdBHevtaCcY15yfd2G7nwA62V8OtbPKvQXIm6/PQr4AsBPV1VDSHulWdbsO6FDwFIRXwpGFACILAUQWAogsBBBZCCCypgLgtx9hD5DY/4sImgiA/TQ+CAFE1ogAYJdMug/ON8nhCzA47Dt0cpUksEFdkpwBBMhzBL/5lu4NSLcIhJ/L1XgA7i8Ly27A2Ef8jAcAx4c38Av4XrzgI/16/OhVvjm8YdmOl0xgPABbtiXmitqzBrDiLYECoHmKtyq5x75QM9N4ADZ0m17maWoAJ2tGhQMoTvwqGd6uqUdaskYE8IjtutgJQLWb7GI1ogs6YAMdGQD1Nac3JQDIsy19Px8ZwUaNy9WYnXBxehcW5if9WZFwUHXCdDdMoRPmAGifsOwh6sjD0IM1tyeML//yERuGgpe/To6kYShvAVu6c+x4/8fxFflCbNlnt4sQQGQhgMiayL2g/RUCiCwEEFkIILIQQGQhgMhCAJH1fxyrTtOP3cglAAAAAElFTkSuQmCC" /><!-- --></p>
<p>There are a few tricky distributions for which there exist no
sensible starting values, such as the Student t-distribution and the
F-distribution. You would have to provide a sensible-ish starting value
for the degrees of freedom for these.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">2</span>), <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">4</span>)),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">ggplot</span>(tdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;t&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">3</span>))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>fdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">4</span>, <span class="at">df2 =</span> <span class="dv">8</span>), <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">8</span>, <span class="at">df2 =</span> <span class="dv">16</span>)),</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">ggplot</span>(fdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;f&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><img role="img" src="data:image/png;base64,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" /></p>
</div>
<div id="discrete-distributions" class="section level2">
<h2>Discrete distributions</h2>
<p>The way <code>stat_theodensity()</code> handles discrete
distributions is similar to how it handles continuous distributions. The
main difference is that discrete distributions require whole number or
integer input.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="dv">5</span>), <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="at">mu =</span> <span class="dv">5</span>)),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>incorrect <span class="ot">&lt;-</span> correct</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># Change a number to non-integer</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>incorrect<span class="sc">$</span>x[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">ggplot</span>(incorrect, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; Error in `stat_theodensity()`:</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; ! Problem while computing stat.</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; â„¹ Error occurred in the 1st layer.</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Caused by error in `setup_params()`:</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; ! A discrete &#39;nbinom&#39; distribution cannot be fitted to continuous data.</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>A practical difference can be seen above: using simple lines are not
very appropriate for discrete distributions, as they imply a continuity
that is not there.</p>
<p>Instead, one can work with centred steps:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Or perhaps most appropriately, you can display the distributions as
probability masses through lollipops.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>))</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Warning in stat_theodensity(distri = &quot;nbinom&quot;, geom = &quot;point&quot;, aes(xend =</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; after_stat(x), : Ignoring unknown aesthetics: xend and yend</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="comparing-different-distributions" class="section level2">
<h2>Comparing different distributions</h2>
<p>Letâ€™s say we are given the task of comparing how well different
distributions fit the same data. While we can use more qualitative
methods, having a look at the distributions is still a useful tool.
Weâ€™ll generate some data and see how it works. Weâ€™ll fit a normal and
Cauchy distribution to the data and plot their densities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">5</span>, <span class="fl">0.2</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>From this it is quite hard to see what distribution more
appropriately fits the data. To get a clearer view, we can use a
histogram instead of a rug plot. The problem though is that by default,
histograms work with count data, whereas densities are integrated to sum
to 1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAA+VBMVEUAAAAAADoAAGYAOmYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6OmY6OpA6ZrY6kJA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOpBmZgBmZmZmtrZmtv9uTU1uTW5uTY5ubqtuq8huq+SOTU2OTW6OTY6ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+ioqKrbk2rbm6rbo6rjk2ryKur5P+srKy2ZgC2Zjq2tma225C2/7a2/9u2///Ijk3I///bkDrb25Db/7bb///kq27k///r6+v4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T////S15zwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM/ElEQVR4nO2dCX/bxhHFacdSbPWQHEdO0lauXSmu7LapqLQJ2csyWx+kRB34/h+mWGBxD4a7g4EWJN/72SLFR5CY98cuAGK1HEVQUI1Cr8C2CwACCwACCwACCwACCwACSwbgc13NRzp7AV9SOWNWAEB4yhmzAgDCU86YFQAQnnLGrACA8JQzZgUAhKecMSsAIDzljFkBAOEpZ8wKAAhPOWNWAEB4yhmzAgDCU86Y1foBGI/HACAuTSEtAIgAQFEAQHjKGbMCAMJTzpgVABCecsasAIDwlDNmBQCEp5wxKwAgPOWMWbEAli/fR9HNycGzT/lNKnFpCmltEYDLg6/eR3fnp9HHr7MbK3FpCmltD4CLpz/FLeDm9XvTEuyNtcSlKaS1PQDSLmj56lN08/3P9iZ+8MtY97RypCaTSci319ZKAJfPkuTtjTXE25bC5rr1LcBIXJpCWtsGAPuAfrUSwN35cXoUdIyjoD6E8wDC6z/2Qmt5Jjye6L5k3VPOmBUAEJ5yxqwAgPCUM2YFAISnnDErACA85YxZAQDhKWfMCgAITzljVgBAeMoZswIAwlPOmBUAEJ5yxqwAgPCUM2YFAISnnDErACA85YxZAQDhKWfMCgAITzljVgBAeMoZswIAwlPOmBUAEJ5yxqwAgPCUM2a1fhM2TSYbNTQLLYDwlDNmBQCEp5wxKwAgPOWMWQEA4SlnzAoACE85Y1YAQHjKGbNaUwBmfKLeS9Y95YxZAQDhKWfMCgAITzljVgBAeMoZswIAwlPOmBUAEJ5yxqwAgPCUM2YFAISnnDErACA85YxZAQDhKWfMCgAITzljVgBAeMoZs1onAGnqABABgKIAgPCUM2a1EsDHA6PT5ParsHNFbCcAIzNXzcVp6QFxaZ3S2loAZpqaux9/Lj0iLq1TWlsLwMyScnOSdERRyBmz0gFZE6sw66AuBwDJPE3L35dbgXjb6rS5bmsLuMynqcn3A+LSOqW1rQAujvN7AKCu1QDSjsc0g7u/4TBUXasB2Kn64vOAp/mBkLi0TmltKQBK4tI6pTXOBQDS0jqlBQC5xKV1SgsAcolL65QWAOQSl9YpLQDIJS6tU1oAkEtcWqe0ACCXuLROaQFALnFpndIaGICrJ2ei8KpaXwBtDABAyQMARuLSOqUVGsDtm9Fop7g1AEp3zY+rvT+PHr4DgK5r0pb/TnR9eJTcmv9x4KW7KYDHO75RAgDh0UVnXc7CbOPxj/j30l0L4AgAegOwsJ3L4tGHNO0YQHG3uAWAzmsCALQ1lC7owVneBRV3NQBcHz5wXF5cWqe0BrATLv8v7YSvD/fj2wfdW8B0NDKNCgBaCLQdhkZXj0ej3z3X6IKuD0ejfQC4PzX3AQaq58nEPWlSV+gV0lAdwCxpUtMVHZF42+q0uW5+CzAbf3ImsVjRBMSldUpr4wFcH7p2PeLSOqW1BQCcNv8IABQFAITXW9qECgDx7tdq9Sd64tI6pbXhAPIW4CBxaZ3SCgygbUE9AO4Sl+bhbRuAePM3Z8FG2AeEAOAlcWkeHgAwEpfm4W0jgLQbcjgbE5fm4W0jgOlONHv4bobD0EAA4gZgri7gRCwgAHNpBwBCAbh9s28uck7RBYkALEat1xOv9lq36co+4OrxaGfltQAAqC1oNTMdR0t4rgCcJS7Nw1szANfPzeXg2zdHyfXhoyRz8z8+rHxwdrX3G/PYNH74lzVCAEB4bUXPGyqevMi2fUMiTt4CMEQWj/77eN88YRH/rF9wr3dB+Cjis6wFLMp7zutvMgBp52N/uf7uwz/qwyaqO2HXoaXi0jy8NQNQ6lumZhvOACQPZ83h7V+/q+8jVn8cbecquzk5yGdNAYDmk/N9gEmx6IIqLSCa/bYx5KfaAigA6RQpd+enycRNANBY0Co7CkrCfnJmgMQPJXvlvX9ZAMTArco+gDoFs7M03bx+Hy1fBp8tZcAA8vOA2Wj0xbdH5ubX3+RHQSmA2z81Aq52QcT1ADtX2fLVJztvStApy0IOzFoFwEFXv2o8tPIw1M5VZuYLshPXUOuCFuCiGTH42e084OK0aAEDAkBSGDAASlUAcb91NCPOpi9OB7kP2DgA00f/Sz+RLsnOVXZ3fjy8o6BNA5B8HH1UPxayc5UN8TxgOwA4rQsAaACIZqYLMtdkACAMgORcwuEPZABg5ZOFAFwlLs3DAwBG4tI8vG0DkH0OsU7XAzYKgFHygZ7LGGlxaR7eFgJYuz/QAADv0jy8mjUua4AA0olSmOEP6bMaPtUFDfI8YPgATHgdAaTnAQ5/JiMuzcNbNwB7/9yJsoEoMYurX3z78D9v/xKfVi2SU6tisAoHwFXi0jy8AQLYbehzCcC7aRrwNBmCYrqkZEqPxzvJgIhisAoArPQci648OR11Yn6a65DPk6uQt2/Pkv/pBftssAoArPSEAKLZvt3I49QbAPLBKpsGoM4gIIDbtz+0tYDSYBUAWOlJAaSHQnYfUAVgB6UAgJMnBpAcyNujoFoXlA5WAQAnTwJAqjUBUA0cAO5djTFZAQZoDQmAeNvy8NACGIlL8/AAgJG4NA9vcAD6EQAQnnLGrACA8JQzZgUAhKecMSsAIDzljFkBAOEpZ8xq8ADG+ZcIA0AhcWkeHgAwEpfm4QEAI3FpHh4AMBKX5uEBACNxaR4eADASl+bheQCoMAAAJQ8AGIlL8/AAgJG4NA8PABiJS/PwAICRuDQPrwDQFABIS/PwAICRuDQPDwCsli/MfEHZzGWpxKV5eACQysxRY+YMSmcusxKX5uEBQKpLM0XKxamducxKXJqHBwCF4lZgZy6L7n3KMn5M3Pp/s6QLADNXkJ25zD4i3rY8PL8WUDSCzWsBNyfH9l6+HxCX5uEBgNXyRb77BQB9rZ41Mc3fzlxmHxSX5uEBQCpz/G92v3bmslTi0jw8AGAkLs3D8wZgGQCAkgcAjLRCBgAAoDzljFkBAOEpZ8wKAAhPOWNWAEB4yhmzAgDCU86YFQAQnnLGrACA8JQzZjVkANSAFABIpBUyAAAA5SlnzAoACE85Y1YAQHjKGbMCAMJTzpjVsAG0CQCUQgYAAKA85YxZDXnKMvcxWWs8NgstgPCUM2a1lgDmcwDQCVkGYN5KIFlu3PI1qwDg57UCiMOftBBIlgMAHa8NgMl+Mm7vhABAyWsFME4AtHZCAKDjtR3pJMFPxm1NAADkZVe1CkALAQCQl11VC4A09nYAqddxTZQzZrVmAOYFgDYCAKDg5SHTDWAlgBYGAODqtQFIGkD6BVKtBABAwWsFYKOfJBToQ1EAUPBIAHHitZDnCQ0AkIXc4uXXIasAqlt8BmA+3m0wAIBuHgkgibnU42Retk8AAFk3U/XG1YvwBQC7y503Qs4erBCoASizAAAJALuBV/a4BRz7cKkVAIAvgJbRJ5NKsNUjnlL3NK8jKAPI7o5XXqsBAApAKf553SsjsHeyQ1QAWOVlocRptQPYbY2/cYhaQUBNZZMCiK36SqwRgJuTg2efsl96B5CnP2+m3wRQftpu88B0IwDcnZ9GH7/OfmuUwQLIYigvlCVJAMg+aEjVTJ8CUHp+epZchlAHMC7esVilMpx+oqblCuDm9fto+bI5WYcegHldZPTtAKocyq+yEQCWrz4l08c1Z8xqBCfVrn510a772/fw7i5yBWCmq0kBGDW3cq4FyLyAL9lX2JT8W4DRkNLq4SX7CptS131A+LR6eMm+wqbkfhR0TB4FhU+rh5fsJ2paQc4DVNPq4SX7iZrW4D6OHsJLKmfMCgAITzljVgBAeMoZswIAwlPOmBUAEJ5yxqyU/kZMOp23cLn7XaxXAUBgAUBgAUBgDfnvhLdCABBYABBYABBYABBYHQEsX2Tf7nZ3XvqCB4/linsOS5krQsXn4pVPyN0Xs99MNxB1A3Bzchp9TOu6OE2uG/suZy5zfnRc7tKgKsbHVEfKOC+WfTPdQNQNQHGl2FyylCyX3HNb9uLpT/GmXFwbrV4ldV7MfjOdx9r2Ki0Ay1d/9+iCSuA8WkCSYI3d9w7vWV0ssu86ECl0QUnu5suWTJG+yzl35EYmyWJ8THWkjPNiUXqBeyjqvhP+w49em2N9ubg3vnTdCyu1gOKb6Qag7oehaQ9+80cvAPlyzpux0VKyD6gvVv5mugGoYxdkevD0QOTCqwvKl/NuAcX4mOpIGefFhpV/1xZweWB68GQTO3E/ni8vF99z3nmXDujtW/qeB8R3s2+mG4hwJhxYABBYABBYABBYABBYABBYABBYABBYABBYgwcwe3AWXR/uh16N3jR4ANF0x/zbWA0fwNWTH/behV6J/jR8ANFsdBR6FXrUGgCYjja4B1oDAIuH/z7c4CYweADXcfqLh5u7Exg8gOmjD9Htm83thAYPYNMFAIEFAIEFAIEFAIEFAIEFAIEFAIEFAIEFAIH1f2Qrrw6mmpBgAAAAAElFTkSuQmCC" /><!-- --></p>
<p>There are two possible solutions to this:</p>
<ol style="list-style-type: decimal">
<li>Scale the histogram to densities.</li>
<li>Scale the densities to counts.</li>
</ol>
<p>A nice thing that ggplot2 provides is access to computed variables
with the <code>after_stat()</code> function. Luckily, one of the
computed variables in histograms already is the density.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAA9lBMVEUAAAAAADoAAGYAOmYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6OmY6OpA6ZrY6kJA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOpBmZgBmZmZmtrZmtv9uTU1uTW5uTY5ubqtuq8huq+SOTU2OTW6OTY6ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+ioqKrbk2rbm6rjk2ryKur5P+srKy2ZgC2Zjq2tma225C2/7a2/9u2///Ijk3I///bkDrb25Db/7bb///kq27k///r6+v4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T///93gpnjAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANf0lEQVR4nO2dC3/bthXFFS/mEu9hd63TZpvdpXNbJ9s6M+0m7RVHWxxRtmSH3//LjHjwBYI0APEKIHnOL5YlHUHmvX8CIAkEnKWQV818b8DUBQCeBQCeBQCeBQCeBQCeZQpg1ZDmLVOXqmhf30uacUUAoDFJM64IADQmacYVAYDGJM24IgDQmKQZVwQAGpM044oAQGOSZlwRAGhM0owrAgCNSZpxRQCgMUkzrggANCZpxhUNDECS0HwvAJi5yQoAeo/WxgUAgmhtXAAgiNbGTVZpFwEAcInWxgUAgmhtXAAgiNbGBQCCaG1cACCI1sLNkg8AvUdr4QIARbQWLgBQRGvhAgBFtOZunMQA0H+05u6kAYSgeTJP08T3VvQs1ACNSZpxRYMD0HU9FABcojV3AYAkWnM3iQGAIFpzFwBIojV3AYAkWnMXAEiiNXcBgCRacxcASKI1dwGAJFpzFwBIojV3AYAkWnMXAEiiNXcFgA4CAOASrbmbAYjnANB3tOYuAJBEa+4CAEm05i4AkERr7gIASbTmLgCQRGvuAgBJtMYuyz8A9B+tsQsANNEau5MDsDk/+c37/AVdtMbu1ADcX1ymN59/lK/oojV2pwZg8+pjev/t3+UrumiN3ekC+Hmm/W1Rq5I509hmhz7SBH2GGkCs7k74mx8BgFjdh6H33+WHQXTRGrtTA8Da/5sv8ld00Rq7UwOQ3p6cFEehAEClAZ4JtxMAAJdojV0AoInW1E1WAEASrakLAETRmroAQBStqQsARNGauhJA9gMAvUZr6gIAUbSmLgAQRWvqAgBRtKYuABBFa+oCAFG0pi4AEEVr6gIAUbSmbgmg9UwMAFyiNXUBgChaQzdLOgCQRGviioYfAEiiNXEBAACoBAAakzTjigBAY5JmXBEAaEzSjCsaxsKt8/k84Y9ifu6YpueiBmhM0owrAgCNSZpxRQCgMUkzrmiQANoI7BfA3fMr57SXGg6AOAYAkmhNXAAAgEwPr2ezw/I3A1B5yh7ujv48O3gHALtuUlv+D9Pt6Rn/zX6yhFeeCgDPDq2yDwB6U5+CvMlZs308e8heV55KAGcA0MMm6VOwlo3L+ukHke0MQPm0/A0AO28SAKgKAkDRBD25Kpqg8mkfALanT1rL00Vr4hb55wBaJ6bQd8LVn0onvD09zn4/2b0GLGYzVqkAoIVA22FoevdsNvv9iz6aoO3pbHYMAPtTsw9gUJsnE3TRmrgTArDkVWrRaIjoojVxpwKA7fz8TGLdqAJ00Zq4EwGwPW2/jkEXrYk7GQAtu38KAGQaFoAo02gBZN2vlO6KHl20Jq4EkGV/zgmMEkBRA7Sii9bEFQAi3gQxAl4AtJXsD0CX6KI1cTmASACI26vAoAFkuz87C2aSfcCntyfFmn2+AeQVgHfCrVVg0ACaur5MbwNZuJVXgPIoKJoEgHLBviAARPEEAIhmSLZAm1c/ySbI/8Kt82QezSuKfMwO3QOAxWG6PHi3FIehm/NLvnpu21/3WAPiaJw1IKsAbHRBnoiFtHZ0nETxNACwoR0J4P77cAGMtA94eH3MBjkX8kz4OqgmKHwA61nreOLdUetVzlofcPdsdliOBdxfBHMDhyaAqJfvbTGdACxZw9EcSLEC0CG6aE3cAQDYvmDDwQ+vz/j48BnPOfvJDiufXN0d/Za9t8je/qVCaBgAIhWAfmIKNYCkofLD63zfZySyzEsAjMj66X+fHbMPrLNHdcBdbYIqlyLCBqCrAj5rwLp6DXn7ZQ5AND7yxfblh3+o0ybqnXD71FK6aA3cqNEEhQeg0rYs2D6cA+Bv59XhzV9fqn3EIC5HDwFA0QewLJZNUK0GpMvfNab81GvAgACsNASCOAriyX5+xYBkb/Fe+ehfEoBm4latD9AORvoHEDWPggIEUJwHLGezn311xn79+sviKEgAePhTI8H1JmgWZCc8EAAGuvtV460hHIZGqyL/wwaw1Ex+Hi4ADYHQAehUB5C1W2dL7dm0ZTx9AohWkwGwePo/cUUaALwA4Jejz4KbmNUGoEkAAFyifcxlaZ4IgHTJmiA2JgMAfgDwcwntf5AJDYCcqki0Sf4AtMsyHnIAYqoW0SYBQEX1/I8YQH4dIrRLEZMBwMQv6OkvSlvGsx8Aajc8dABB/gcNAPALgKd4CADEQikd0x/Epxq+rgkK6TxgQABY8nYEIM4DrJe8oVTEHpJ5U+w9ae9JjwA4+udhmk9EyVjc/eKrg/+8+Ut2WrXmp1blZJW6Aj8MFbt4aw1QqgB1DYgaWlUAvFuIBC/4FBTWJPElPZ4d8gkR5WSV4QEQNy9RADAC+wagL1kA2L5kA8JbNg75go9CPry54j9iwD6frAIAj5qOANLlsdzJs6w3ABSTVQYHIK60QGEDeHjzQ1sNqExWGRWAOgHfAMShkOwD6gDkpJShAeDpHRAAfiAvj4KUJkhMVgEAI9MFgKuGDqBGAABcou1wRXLbAcTKyTAAuETb4QLAAABUCQCAS7QdblgAaBQ6gDLVKgDxNgDsHG27y8/C6vkHgP6jbXcBoCLnLFqbtgAqBADAJdpWV5yFAYCQaxbtTQDQyjWL9qYxADkoViEAAC7RtrnyJKCefwCwzKKDCQBaOWbRwQQArRyz6GAWAHh2AUDKMYsOpj2AgsDIANye+FywKYofBZCPyYwUwOYP79ObL/JXbll0MQGgIgZByC2LLqYDgJzA+ACIGuBl4daIz/1M57p5odX5ofxT+5wi2rO6AGzO/S3eHa1kDahXgEYNiKtXI8ZXA/ytGwoAQteX8olTFp1MFwCSwLgAsKXrPdeAMslTBJDenPi7gYMcDW7kvw6guCI9TgA1uWTRzQQArVyy6GY6ARAEAMAlWp0rR4MBoJRDFh3NGgA1/woA5XocALhEq3OtAMTFqQAAuESrcwGgIYcsOpoAoJVDFh3NzM3nQwBAKfssupqOAFghAHCJtunmw/Ga/KsAyk8AgGu0TRcANLLOorPpCiAjAAAu0TYkL+5r898AUHwGAFyjbQgAdLLNogcAqwgAXKJtyA5A9VQAAFyiVZWnUZt/ADCMBwBMNSYAuruaOG0SacYVBQcgO5aJtfMh2gA0huZ33yTSjCsaFYC0kwAAGJkFAG3+dQDKgUkAcIm2LnZFBwA8ik2zFRNuu2blaubolsWHpcBqAB9W4fuzvgJoa0AxNJ92dsPDrgGW8ewKQH8M+jiALgIA8LgpJpd05F8PIP+fGgDgEm1VrgCyj+ff204AAB43CwAJACiyjMcNgJxi21EBWgEk+fcCgG20FRUAWvPfBiCWAOLmnX0cNok044pCApD/R6P2BqgdACcAAC7RlioBtOa/A0DWDXAArY0QADxm5gA68t8OgHUDAOASbSH98ijGADICAkAbAQDoNvOh4KQjx50AYgBwilYqkmlLOnPcbSbymoSeAAB0mnn+dwEwTzRr2jtsEmnGFYUCQFQAvgvvAEAewAKAAwD2INK3CwD9/cVsN4k044oCAcBv2SlvV7UbAH5CUPQobptEmnFFYQDI8pWwyzl9AIj5NwGAjRlFCd9v+wGQNUEZgiYBAGgzkyQ/fuwLAP9OFQEAcLH8VM2EtxgrTRp3AiC+uXgOAFoALPlJFBX7fr8AVlEi6QJAE0AikhPHUeSUYwMA4rtXBYXJA4jzxjnP/Yp1v445NjSj/CYQSb02rOJq4xQogPuLk88/5i92A5BUxBPFU6BNf78AYnbTZZ7szK1tR/gAPr291C/cGhdzQPRKNJLlikSt2M4f1Zp+GgAxvw12DqDc/MYWVnnsJfNS7QDuv3uvX7i1qNBt4jHI8Ovgyt0yisrjTloA2R8Rtx+vAVA2T+wTYQHYvMoX7Wss3Nq8t7qdiGPSK8RtSsNdNdHr9+4n9UImNYCJLtoei44LQGsf0HO0PRYdF4BPb//oc/l6n9+7l8xL7ec8YE9FRwagJrpoeywKAC7R9lgUAFyi7bEoALhE22NRAHCJtseiYwbQ1A63lRlcUUIBgGcBgGcBgGeFtlTB5AQAngUAngUAngUAnmUPYHOe32b409vKjcbsipbPDEuykaHy+njtSrld0ewvn1w+UmSfsgZwf3GZ3ohgri/5wLFDUTbUeWNR9JbhKufJ1GfMWBVlf3nztdVuQytrAOVQMRuzdCzKn5kXv/7sb9luXI6R1kdLrYreMgzXAVWBHQBsXv1k1wRV2FnWAJ49hd+3hn+6XjRNU/Oi+5BbE8Tzvjm/5JE5FLVqxJlYFst5MvUZM1ZFUzHYHY6cOuFvfrTeD5WiWSt8a9ML91gD7i9Cyr/bYahovu+/twVQFLXahZk2rn2AWpTX25Bk3wSx5lscgVzbNkFFUacaUM6Tqc+YsSoaWv4dasDtCWu++X51YXcwXymaPbPrv8uDefmXXc4Dsqc3J0wBQcCZsGcBgGcBgGcBgGcBgGcBgGcBgGcBgGcBgGeFC2D55Crdnh773gxqhQsgXRyyf2NXwADunv9w9M73RpArYADpcnbmexPoFTKAxWz8LVDIANYH/z4dfxUIF8A2y/76YPSdQLgAFk8/pA+vR98IhQtgIgIAzwIAzwIAzwIAzwIAzwIAzwIAzwIAzwIAz/o/tPt/kFyVD4kAAAAASUVORK5CYII=" /><!-- --></p>
<p>Now we can see that probably the Cauchy distribution fits better than
the normal distribution.</p>
<p>Alternatively, you can also scale the densities to counts. To do
this, we must know the binwidth of the histogram. Since different layers
in ggplot2 donâ€™t communicate, we have to set these manually. Just like
histograms provide the density as computed variable, so too does
<code>stat_theodensity()</code> provide a count computed variable, which
is the density multiplied by the number of observations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>binwidth <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> binwidth) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rolling-kernels" class="section level1">
<h1>Rolling kernels</h1>
<p>A rolling kernel is a method that generates a trend line that doesnâ€™t
require specifying a model, but is also very bad at extrapolating. It is
similar to a rolling window, but data does not need to be equally
spaced. An attempt at illustrating the concept youâ€™ll find below.</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>For every position on the x-axis, a kernel (above: Gaussian kernel in
blue and green) determines the weight of datapoints based on their
distance on the x-axis to the position being measured. Then, a weighted
mean is calculated that determines the values on the y-axis (red
dots).</p>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>Below is an example for a Gaussian kernel on the <code>mpg</code>
dataset.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>It is pretty easy to visualise areas of uncertainty by setting the
alpha to scaled weights. This emphasises data-dense areas of the
lines.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(scaled)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="relation-to-kernel-density-estimates" class="section level2">
<h2>Relation to kernel density estimates</h2>
<p>It may seem pretty trivial, but using the weights as the y position
gives something very similar to kernel density estimates. The defaults
for the bandwidth differ slightly, so we exaggerate the similarity by
setting them equal here.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stage</span>(hwy, <span class="at">after_stat =</span> weight),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                         <span class="at">linetype =</span> <span class="st">&quot;Rolling</span><span class="sc">\n</span><span class="st">Kernel&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                     <span class="at">bw =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(displ, <span class="at">colour =</span> class,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">after_stat</span>(count),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="st">&quot;KDE&quot;</span>),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>               <span class="at">bw =</span> <span class="fl">0.3</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>               <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="rolling-mean" class="section level2">
<h2>Rolling mean</h2>
<p>As a final note on this stat, a rolling mean-equivalent can be
calculated using the <code>&quot;mean&quot;</code> kernel. This is the same as
setting the kernel to <code>&quot;unif&quot;</code>, since it uses the uniform
distribution as kernel. Typically, this is a bit more blocky than using
Gaussian kernels.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="at">kernel =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">bw =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="difference" class="section level1">
<h1>Difference</h1>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Many people who try to illustrate the difference between two lines
might have run into the following problem. In the example below we want
to illustrate the difference between the <code>uempmed</code> and
<code>psavert</code> variables from the <code>economics</code> dataset,
and change the colour of a ribbon depending on which of the variables is
larger. Because the groups are inferred from the fill colour, and there
are small islands where <code>uempmed &gt; psavert</code> is true, the
ribbon will be drawn in an overlapping way. This makes perfect sense for
many visualisations, but is an inconvenience when we just want to plot
the difference.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmin</span>(psavert, uempmed), </span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fu">pmax</span>(psavert, uempmed),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                    <span class="at">fill =</span> uempmed <span class="sc">&gt;</span> psavert),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>To circumvent this inconvenience, <code>stat_difference()</code> uses
run-length encoding to re-assign the groups and adds a <code>sign</code>
variable to keep track which of the two variables is larger. By default,
the <code>fill</code> is populated with the <code>sign</code> variable.
We can control the name of the filled areas by using the
<code>levels</code> argument.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">ymin =</span> psavert, <span class="at">ymax =</span> uempmed),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;More uempmed&quot;</span>, <span class="st">&quot;More psavert&quot;</span>),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">alpha  =</span> <span class="fl">0.8</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="interpolation" class="section level2">
<h2>Interpolation</h2>
<p>An additional nicety of <code>stat_difference()</code> is that it
interpolates the cross-over points of lines. Itâ€™s not very visible in
the densely populated graph above, but we can generate some dummy data
to show what we mean.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">2.5</span>), <span class="at">ymax =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymin)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymax))</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ymax <span class="sc">&lt;</span> ymin)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Plain ribbon&quot;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;stat_difference()&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><img role="img" src="data:image/png;base64,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" /></p>
</div>
</div>
<div id="function-x-y" class="section level1">
<h1>Function X, Y</h1>
<p>Sometimes, you just want to calculate a simple function on the x- and
y-positions of your data by group. That is where
<code>stat_funxy()</code> comes in. It takes two functions as arguments,
one to be applied to the x-coordinates and one to be applied to the
y-coordinates. The primary limitation of this stat is that you cannot
use functions that are supposed to work on the x- and y-positions
simultaneously.</p>
<p>For example, it is pretty easy to combine <code>range</code> and
<code>mean</code> to construct range indicators.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="fu">stat_funxy</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group),</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>             <span class="at">funx =</span> range, <span class="at">funy =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">&quot;both&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div id="centroids-and-midpoints" class="section level2">
<h2>Centroids and midpoints</h2>
<p>There are also two variations on <code>stat_funxy()</code> and that
are <code>stat_centroid()</code> and <code>stat_midpoint()</code>. While
the default function arguments in <code>stat_funxy()</code> do nothing,
the default for <code>stat_centroid()</code> is to take the means of x-
and y-positions and <code>stat_midpoint()</code> takes the mean of the
range. Under the hood, these are still <code>stat_funxy()</code>, but
have default functions. The centroid and midpoint stats are convenient
to label groups, for example.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Centroid&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">stat_midpoint</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Midpoint&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;limegreen&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cropping-data" class="section level2">
<h2>Cropping data</h2>
<p>While for the general case the data should be cropped to the lengths
of the function outputs, you can change this behaviour by setting
<code>crop_other = FALSE</code>. This might be convenient when you might
have other aesthetics that you care about, in the same group. Not
cropping other data probably only makes sense if the functions you
provide return a single summary statistic though.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">xend =</span> waiting, <span class="at">yend =</span> eruptions, <span class="at">colour =</span> group),</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="at">crop_other =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="run-length-encoding" class="section level1">
<h1>Run length encoding</h1>
<p>Run length encoding (RLE) is useful as a data compression mechanism,
but can also be useful in plotting to check if subsequent conditions are
being fulfilled. The default behaviour of <code>stat_rle()</code> is to
draw rectangles in the regions where a series of values (a run) have the
same value. Letâ€™s say I have the following series:</p>
<blockquote>
<p>A-A-A-A-B-B-B-C-C-D</p>
</blockquote>
<p>This series can be compacted by run length encoding, but can also be
useful to extract the following properties:</p>
<table>
<thead>
<tr class="header">
<th align="right">run_id</th>
<th align="left">run_value</th>
<th align="right">run_length</th>
<th align="right">start_id</th>
<th align="right">end_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div id="examples-1" class="section level2">
<h2>Examples</h2>
<p>In the example below, weâ€™ll use the <code>cut()</code> function to
divide the y-values into three bins, and use the <code>stat_rle()</code>
to draw rectangles where datapoints fall into these bins.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">cos</span>(df<span class="sc">$</span>x)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: y.</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; â„¹ This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;   the data.</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; â„¹ Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This can be made slightly more pleasing by closing gaps between
rectangles.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>)),</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>           <span class="at">align =</span> <span class="st">&quot;center&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: y.</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; â„¹ This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt;   the data.</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; â„¹ Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="using-computed-variables" class="section level2">
<h2>Using computed variables</h2>
<p>An alternative use case of <code>stat_rle()</code> is to use the
computed variables to describe a series of data. For example, if weâ€™d
like to summarise the above graph in just itâ€™s runs, we might be
interested in what order the runs are and how long the runs are. If we
make use of ggplot2â€™s <code>after_stat()</code> and <code>stage()</code>
functions, we can grab this information from the stat.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="fu">stage</span>(x, <span class="at">after_stat =</span> run_id),</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>               <span class="fu">after_stat</span>(runlength),</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>               <span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>),</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">after_stat</span>(runvalue)),</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>           <span class="at">geom =</span> <span class="st">&quot;col&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
