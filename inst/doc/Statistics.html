<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Statistics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Statistics</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code></pre></div>
<div id="theoretical-densities" class="section level1">
<h1>Theoretical densities</h1>
<p>One of the more useful tools for inspecting your data is to view the
density of datapoints. There are great ways of doing this, such as
histograms and kernel density estimates (KDEs). However, sometimes you
might wonder how the density of your data compares to the density of a
theoretical distribution, such as a normal or Poisson distribution. The
<code>stat_theodensity()</code> function estimates the necessary
parameters for a range of distributions and calculates the probability
density for continuous distributions or probability mass for discrete
distributions. The function uses maximum likelihood procedures through
the <strong>fitdistrplus</strong> package.</p>
<div id="continuous-distributions" class="section level2">
<h2>Continuous distributions</h2>
<p>Plotting continuous distributions is straightforward enough. You just
tell <code>stat_theodensity()</code> what distribution you’d like to
fit. It automatically performs the fitting for groups separately, as
shown in the example below where we artificially split up the faithful
data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>We can compare this to kernel density estimates, which are more
empirical.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Theoretical&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Kernel Estimates&quot;</span>), </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>There are a few tricky distributions for which there exist no
sensible starting values, such as the Student t-distribution and the
F-distribution. You would have to provide a sensible-ish starting value
for the degrees of freedom for these.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">2</span>), <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">4</span>)),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">ggplot</span>(tdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;t&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">3</span>))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>fdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">4</span>, <span class="at">df2 =</span> <span class="dv">8</span>), <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">8</span>, <span class="at">df2 =</span> <span class="dv">16</span>)),</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">ggplot</span>(fdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;f&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><img role="img" src="data:image/png;base64,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" /></p>
</div>
<div id="discrete-distributions" class="section level2">
<h2>Discrete distributions</h2>
<p>The way <code>stat_theodensity()</code> handles discrete
distributions is similar to how it handles continuous distributions. The
main difference is that discrete distributions require whole number or
integer input.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="dv">5</span>), <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="at">mu =</span> <span class="dv">5</span>)),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>incorrect <span class="ot">&lt;-</span> correct</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># Change a number to non-integer</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>incorrect<span class="sc">$</span>x[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">ggplot</span>(incorrect, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; Error in `stat_theodensity()`:</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; ! Problem while computing stat.</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; ℹ Error occurred in the 1st layer.</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Caused by error in `setup_params()`:</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; ! A discrete &#39;nbinom&#39; distribution cannot be fitted to continuous data.</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>A practical difference can be seen above: using simple lines are not
very appropriate for discrete distributions, as they imply a continuity
that is not there.</p>
<p>Instead, one can work with centred steps:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Or perhaps most appropriately, you can display the distributions as
probability masses through lollipops.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>))</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Warning in stat_theodensity(distri = &quot;nbinom&quot;, geom = &quot;point&quot;, aes(xend =</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; after_stat(x), : Ignoring unknown aesthetics: xend and yend</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="comparing-different-distributions" class="section level2">
<h2>Comparing different distributions</h2>
<p>Let’s say we are given the task of comparing how well different
distributions fit the same data. While we can use more qualitative
methods, having a look at the distributions is still a useful tool.
We’ll generate some data and see how it works. We’ll fit a normal and
Cauchy distribution to the data and plot their densities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">5</span>, <span class="fl">0.2</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>From this it is quite hard to see what distribution more
appropriately fits the data. To get a clearer view, we can use a
histogram instead of a rug plot. The problem though is that by default,
histograms work with count data, whereas densities are integrated to sum
to 1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>There are two possible solutions to this:</p>
<ol style="list-style-type: decimal">
<li>Scale the histogram to densities.</li>
<li>Scale the densities to counts.</li>
</ol>
<p>A nice thing that ggplot2 provides is access to computed variables
with the <code>after_stat()</code> function. Luckily, one of the
computed variables in histograms already is the density.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Now we can see that probably the Cauchy distribution fits better than
the normal distribution.</p>
<p>Alternatively, you can also scale the densities to counts. To do
this, we must know the binwidth of the histogram. Since different layers
in ggplot2 don’t communicate, we have to set these manually. Just like
histograms provide the density as computed variable, so too does
<code>stat_theodensity()</code> provide a count computed variable, which
is the density multiplied by the number of observations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>binwidth <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> binwidth) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rolling-kernels" class="section level1">
<h1>Rolling kernels</h1>
<p>A rolling kernel is a method that generates a trend line that doesn’t
require specifying a model, but is also very bad at extrapolating. It is
similar to a rolling window, but data does not need to be equally
spaced. An attempt at illustrating the concept you’ll find below.</p>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAACx1BMVEUAAAAAADoAAGYAOpAAZrYZGUgZGXEZSJcZcboaGhoekPsekP0ekP4ekP8ekfsekfwekf0fkvkfk/Qfk/UflPEflPMgkf8gluohkf8hlughmOQhmeAikv8jn8wjoMoko74ko8AkpL0lpbomqK0olP4plf8pso0qlf4qtIcqtYQrl/8rt3wruHgsuXQsunEsvGwtvWctvmMtvmUvxFEwx0cwyEMwyT4xyUAxyjwxyzgxyzkyzDQyzDYyzDcyzTIyzTMyzTQyzTUzMzM0zTQ0zjQ2zjY3zjc4zjg6ADo6AGY6kNs8n/8+zz5A0EBBz0FD0UNIGRlIGXFISJdIl91NTU1NTW5NTY5NbqtNjshRp/pWrP9e1F5frflgrflj2WNls/9mAABmtP9mtv9n1Wdr1mts22xuTU1uTW5uTY5ubo5ubqtuq+RxGRlxGUhxGXFxuv9x3HFyuf982XyE4YSOTU2OTW6OTY6Obk2ObquOyP+QOgCQtpCQw/SQ2/+WxfOW3ZaXSBmXSEiX3f+bzv+hyvKh0f+h36Gh6KGlzPKpzvGrbk2rbm6rjk2ryKur5OSr5P+t4a2t662u1/+y2f+y4rK2ZgC20/C2/7a2//+32/+41fC6cRm67rq6/7q6//+747u+vr7A8MDB2O/F4v/H5P/Ijk3I///K8srM3e7P5s/W4u3X6NfY6NjbkDrb///dl0jd3Zfd6d3d7v/d/7rd///f5u3f6d/g9+Dh5uzh5+zh6eHkq27k6Ozk///l6uXm6evm6ubn6evn6ufn6+fo6uvo6+jo9P/o+ejp6uvp6+nq6+rq6+vq+urr6+vx/PHy+f/0+f/0+v/0/PT3+//5/fn5/vn6/P/7/f/7/vv7//v8/v/9/v/9//3+//7+////AAD/tmb/unH/yI7/25D/3Zf/5Kv//7b//7r//8j//9v//93//+T///+YG/XfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAT8UlEQVR4nO2did/cRBnHX1FoX3EQ8NZ6H1W8b+QIigoqeAAvBW9UBJUCUvGoB2AVDzxABRWPsqJFQfH1qFjaIhaK4ouDFVQUwdDa0krzRzhHJplJZpJJMpmZZOf3aXezu887eeb5Zu7Z7EwS5FQzrh2YdgUAjhUAOFYA4FgBgGMFAI5lFADUkJbRFFgFAI6tAgDHVtMAYDKZWD5jA6spADCZUAIBQE9ZCAACgA5WUwAgtAE9Z6HeKpSAXrOgUwIwgQCgpywEAF4ASCt6mQKAfrNArFhXR6rQBvSahXoACws9nNGQVS8AHIgAUH149902XWmnoZeAqjZg+kqA3SykVuvUnwcAvWYhAAgAOliNEEC5NQgAes1CAYCkQxoA9JqFAGCAANSd1gCgrZW6DSivB1SMmwOAtlZ5L+gW8VPJilgAEABkNuYA7HjfFUMBMMo2YNvcsiEASEN/pTW/6mxMAVhz/FeGUALYi/EByKqgww8/vHtaLbQlO/pP4RN+oppNW//WjlP6GmkbQC/3m/JxgKQEiO3B8EuATwDScCMA+Lpnb+GnK4s2vflVZzM+AFw8MwBclNeTxwCg96kI/MgAxLmmHgDLbd8A6BP+j6LOlQDMAFa2AVWLmy38qrMxByBXxfmySNgBgAMutgGoBGACfDd0hZBW5f6KFn7V2YwOAMxqIPxMLnfcC1rAVvit9aQUBAA99oI2szNBWt1kAMjJaRsQc38+VQD6bwMYAKQ4PZkEwJUcARHAyNuAHrKgBBCzi1kGgCsDBQDwCGN+6ZSl0QJA1U8RAGsDoCUAOrXZaAHg+OYdohQA/B03EMsI8ACwbQCgZ5VnrgwgjvPQ0zCUAWQEVghpTiYBgJYVl7sSgJj/VAmAEegNwLjbAAmA9I3NMfQEgI5NHwCsiMSKe70leycufEqO7iKHf0uS28gBXQ+IyeOHxFSTI3v1W6HhlYByG8AGv5vFTyG8cUHWCGORMiD0giKT3VAdmyYA5mex9lrtBwB4jmC1bkIBxOV6Vw2AECgC8HYkvPP0VVsXJ/OLaw1NOdcIQB7/UvwUAIg5LAHQ6rt0957ZNAFwxmr6z18A+eiXlxxA+gc2AFQk2ATAfZ9ehf5tP8ZjALE0fBgAfbcMABHoHUBVik0AJCj2W2dnj6u1a+JcB6tyG5AOf4uGNy6wGOgAMN8GGAOgqybOdbAqAIAb4+vxwc2bi4ZyACzQcakXdHQ3v0pWpgDQ2t/XNmAdupabAYAX04/5tYFeAJhpA3Yun6VatNYXACxfFEC8sQKApA3IAKzgCfQCoMpGG4DWtW8VQFayiVUMKwEsLJTHAQwAWznD8hmAtsRTcNcXVxQNA4jjdR0AZE6SBHsGEIs2TQC0HAln1xffGJkCgFNMcKa6AaBhocn1CiCOCzYNAFSOhHedPXfCdXIA2VkNAziHEUhw8hQAetUOALeCQwFUdkblfhX/RBkI3qYJgIqR8O4LViYbTlQBSM9sGgD8Iht+wRQAedkOACST2HjfFgFQPRyT+lX6k5JVKfzmRsK7PnJFvjVO6nNhkGQQQMzPhrYHgC8SsnuxNwCS+BsbCe/4wHXJrg9fmFR8PwBlTeck+jo/uRRP4KepbmHxn9xZNPzX3UlyF1kQENcDfkA/ztcD0v2jr09q7n8jV82fVGe/ay9o2wkMQFLRDeUuAcFIebHVlgCSJj8d3boNIP5R9dIGyC5/aK4bmpeAKgBcI5RwDquLez2A+HIBALy5ZS8odS8HAE+GagrNK1BF/BsB2P4mdSe0vg0oOJKwCXzYBIBghwHE0CQArg0gAJSONQagin8TAFv3XEUonCn7cPcFp1X2gkquJJMWAERDBAAlJgKYdAMAxRJAzydxrikAZfwbAEAdIFoOjpXOBVWOAwRRZ3gA2m1AEQBOKgPAilQnABGeiqAV5cn5UK/kXkMA6vg3mYxL+//dZ0NJ/hIhY5vqskBVDWCjKQBHk4RZG9AKAPkTZlURfycA0p4Lny1NAIU2IMa9oF4AYA8xAHiuvIKsyyL9G2pVHv0KKTkBgPInGukCgEuFRAoAftO9DWAAUOIpAGkD1QBAZfhbrQcY2ZYSdwcQn1MCcP2mjr2gHACMKQB5B0EfQE383S1JxkLJbAEgTgdil6cB6gqAJpMBSGeYmgHITemouD7+TteEOec6AGAR6giAdXdSAPgQ+9cIAG9Lj2vj73ZRPnevMQBcfgiAiWEAkxzAhG3yvazeL5ilwR/Xx98hAHqBpB43A5DmLJuO7gsA2+beFoBG/N0BSHOYfo9uE5SPxqQAUM6IaQ4Af2KgDeAApN7EjQAIWWDT5DVyDIDFcpNiPkIPgJle0BuID1kv6K2kF0QuEG0Agopdbbl6AaAjGjlcTvEU+h0Jm5qomYM/AP9pTM3S9YDJr8gnW5Lb//KPO5I7k3+3XA94I/r/qihKkiPxekDyjg/ix8/HX/te8uMGmcqOGy5+uGkDyDWHa8pNQiVccaXhEsC+/kt7QZ+FPzFWAuAro0IJOBfGF2mXAM59Ot2izn6ekjMA6fMtpDO0CfKVcEVGCQD4NnLsJwDadlRYFVLyAAC6XEgv6FqNZe2lJHM5AGzfL4DPxRmA3LlKAFn3fzAA0ivmWo2NHUuJaQaA5LdnABfFKQDu8lD3gnCdmi861csTAJuwzwgAvEpulWkpyZxdAJJtTcoskl6F0nuJfAGAL2xvAVzG75uT+cUVXC7+wwKALjMdAPRatNoGkEY4IyDzi2+6+NHvsABQ32sAxHQuiOsFfafvXlABALchPhPf/azyXiafAFwbqwHQTYMxdAWAv/kHVAMo7HyuiQGx8QkAqoZEANmFReKP20JnAGCsBpDNSBV3PuvEwSsAhSzkGZ6kW6bSly4ApARE7wVXS4u/QwRwFZ8JGQDy2gkAROCa9RPuOzm8hO5nMY9VMgig3Y1biwAKX6jJ51akANBrewBgfA3zSAJAcosEuwBa/n5ACQC/jaMIYFIAQOPRIwCUPAcg/x5+OYuS+NsF0Pb3A8oAuIYgKwIxXBLH2fqZNQAkfQ7ANawMlrrH0sUvN1VQw98PoDf7vwM//BX9/wN5ybbSkwDQl0vIG089gDy9kzyen37e33oASZ9bD7j1Nrp8URQ/9z9p+rUCKn/aAHZJxTHrW5Crawl5+ymFbmjPbUCpBKyHvyzN9IsbbPhRsa0SsGZu7kTTANKc5ZmTA4Df7LcXVGgDMADSI8uzWKx8XABIZRwA0llvZ0fWAKD4cb2g98AigHTGObsdfkEBQEcAWQArAVR8e4n7cNgASEb8BlB8VuWxSgYB5NI4bxkAzUUGgGbTQwDEsyR3seMXmbwBkOZCCYDm0YM2AMIbboLjAoDcVwOYcF8jm0xs9IJefcSUAaD+FwGkbYCQSSSHANDZ6WQcAyC0ATIGgwJQbAMg/CT0CsAkUwaAk7QUDAsA3FjohgoAYADQGwDaBigA+NMG5AAmFIAQ8UEDQEErAUDZoQDgm/MMPtzKVERdG5ACKIR8wG2ADADLnU8A4M9gGYCi/yPmsTIOAwFAcuoBAJi1AXmNVJvHyjj0AaCJ8HrAnWQ94PZ8PSC79c5Z70reQt9ZApLkkcX1gEuTH/7o66bXA47gvx/w3iT/fsCfk1tvS/749+Sf1LcJ/X5DdtxNnpWAUhsAlwDoRQn46e+zXegLkOtCywrCgKsgCL+Ae0E4W94CmOCfiZ5UjYUHD4Dky28AVAEAtAnghhIARWcoAEhlGsBNf0rSNkAvj5U2PgPwtA3AACD5UQ7NPFbaeA0AHuVjLygACAACgAAABgCi9O+aKDoXAJgBUHf3dKVzAYAZANp3zi06FwCYAaBx93SsqKTD0P+Do0PQ40EHoocXsfefFT0NPT76idFj6et9QBTtGz3kYeTF48nj06NnR897wTOjF5JXB0YHveTQQ1BaL39F8RwPfBAAe+8NkPYDYH/8DB6DH55ADsEz6NOL0f+Dowgc+rKX4pfPfw5+fC548pPA46jBI8BD9weP2g/s8+B9AUBJljOjVH0A7dw9vXx1kJxBgyUA0gQFkRhAkyWApqiZx2obQwA0754ud45GzASAcvAzkYgZAYCS0sriMNoAKhy47gAgqD5jFBkAQO5s6R8A/bunq5wDoCsA9dWfnREFryMAGEm918ujzMYQgNbjAE4AdgIAtM4YdQQQqbxXnrHGxhQAXi2dA7ALAKB5RhrBlgBYyztOADiG/QOgBNoBiIpp6Z2x0sYnACiIrQEA7TO2B5B3PMcKAIK2AECDM+I4BgAKI8AOmgEAsF6dAXAjrwAAqy0AHMkAQGUE0udGAADUEHfGqA0AfuohAMAKAHoRoE/fSD6DHo/S2hsKGp8kar43VGNGs4u8KQGsCDQpAUDnhMIZI1wCZhqVAGHy0/MS0Mk5QJ8aAAAtwkHCOTNDjrUAiJPPYwaQErAB4GKKIAAQBchjzwBIQHEVhBDoACisvowaACWgDwC0CgcDgBAEAAUB/GAPAGsKAoBMADYAANqFgwOwgiIIADIB2D8AHFKuG4oQVAEoLsAHAFgEANDMaA0AhGCQAPKFyB2nzM2tHDIAUg8NDUC+IRFvSdlxasttKSUBCwBQUIsj4ZkZBYDSFiBfAOSbUbZhDGtWDhsALgXDAiBsx9LZmqgpIJuMm7Ej2WRczxNxWO0ACBsS8dYgqs5XB9AuAUD3SpNYRboloLwJ0ccSsOtsFv/uAFBcXQBQtQH+AuA2JO44ZWX2dnfnrABgga3tBfkLIN+QyMd/mADU4wDJNmhfAKTjAFQINsxhmeoFIQJ6AIB2RmsAVI2E/QEwv2jt/OzsmbV2BpyzC6B6LsgbADtPX4X+bT9m9VgApATqZkP9AXDGalQGfAKQLt50A1C3HiD7JoyrKmh2z1Vb7VRBKLQaAIB+RlUA6lfEPAKgKxPO2QGgsybsDwBUBWWPowCgtyvCFwA7l89SLVprAwAE9QBAg4xKrGbSRnggALSu/UEBgGkrPBgAdgXqtyY235JYFJnmrN6aaGEmFEsLwFZSBe1lpQ3wpgRIv4/tbCCmg8kaANAko6MAYLUNIPHtGwAJ72AAJPPHTR8A+R0hnHZDLbUBAUB7mXEOwGoAoFFGA4DGzgFoAQAmMBgArBKqrYPMOAegBwAUNwVyVAK+ixvh+cVb6yYjDDkHAgBRbDLu+3l3lL9HCt4mFwA0tWoC4L7zSAlY9ItjWQkQ7pW4wdje0FTABgAU4sEAQHUQagEW71yeLcnw98na8f6PWgUAmmW0HQDVfeF86QVxG7N2f+mrtAoysTWRClROxnWfiaOKqibjLM3EJQa2Jm44zXIbAJpdacMvAajxXV7sheYlAB0ZB4BiHABUK28D6Mas0wYIAEYDBiDcK3GgJWBIAO47b3bRr4VFgWxronUAoGFarQAob47rbByw/di1tePgAKCJVRMAaCSMAFjaloIVAIiiJWDeXgmAIAAoENDaFmQDAGicltoqDfMAAOjKlHMBAK+dyzW25Y4LgPoXAlytB+jVQAFAA6tGALC2WluUxwIKAKBFWmMAgBcldeshIwKK2VBTU6FE6ZRneTbU3lyoFgAU/T31tsaZujoslYD0Sve9BGhvTBwNgIpf6XFSBeFRgN7WOFPOISsQAAiatzsQUwEArdJSfjIgALZ7QXYAUAIDAIC/H7BYw86Uc24BVP1Qm6ORsE7wDQOAIABoLlPOBQDTAoAQGCSAfGvi7gvmjmf3LjPlnAoAaJmWWhIAlb/V6QsAbmvimpVkl1AA0NCqG4B8Wwo+ymTKuQCgTvzGrC+nVZC5rYlU6bwbPxlndCqOCE+7FSbjbM7EJd23JuJblmEcRKauDmIF6FG/JQBf70MvAR1+0LnSCtAjDgBonZZaJQCV8fcGANcGfCwAaGXVDQC3NXGNvSoItE5LrYEC4LYmoqNlrCNkyrkAoKVMOUetADnKAYAOaSkVAKitADnqGQAKeACgsALkyDKA6vgHAG3TUisAUFsB/JABAJ3SUioAUFsB/BAAjBwAjHgANfH3HYBp4cm3bDLO/EwcVcRPxlmeiUv8LgHkomclAHRMS6kxlQBTzjkDUBf/aQOACfQOgFz1AYDcCgQAvgAAndNSKgdQG/+pA4AIBACjB4AJBAAKKwYAGEhLKQagPv4BQJe01IoCAKUVIACAkbSUGiAA4Qed+1mSpAL44u8bAIwwAI34ewNA/EHnDX1sTWQCQLYS0C4ttaKBAci3pZB9QWx7oinnBCugjL9JAAiBqbRsAMi3Y+UlwPTWxEx9TYMKsj8NmqrzXRP5e+javYaGbdUNALc18dQLk23L+qyCRmrVDUDeBgg/bm43C8O26gaA+0HnUALaWXUDwG1N3DaXf0XJnEy2576mReXpmrCvQQsARpQWVQDgLC0qTwFMjwIAxwoAHCsAcKwAwLH8BIBGd8uuqDfTED9X2FXmvOLkJQA8ws5+H6KThN/b6ihzXvHyEgAW+5WsbuJ/b8uETKZF5S0AM9ea8EV+A5qaErDjFDMzfMJseWeZ8oqXdwDWzM1lq/3dZboEmEyLyjsAmdasrLeplek2wIxXvLwEYK7iEH5vq6PMVmdMXgLAPw9nqLY1OQ4w5xUnPwFMkQIAxwoAHCsAcKwAwLECAMcKABwrAHCsAMCxRg7g6vt9Krn3pNe5dqNCIweQXPIA/M9jjR3Af1/zidd+27UTVRo7gOTqmXe7dqFSowdwyYzXNdDoAdyzx7dO8roIjBzAvSj69+zhcyMwcgCX3P/nyf8+7nMlNHIA/isAcKwAwLECAMcKABwrAHCsAMCxAgDHCgAcKwBwrP8DVe+eWIUw4SkAAAAASUVORK5CYII=" /><!-- --></p>
<p>For every position on the x-axis, a kernel (above: Gaussian kernel in
blue and green) determines the weight of datapoints based on their
distance on the x-axis to the position being measured. Then, a weighted
mean is calculated that determines the values on the y-axis (red
dots).</p>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>Below is an example for a Gaussian kernel on the <code>mpg</code>
dataset.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>It is pretty easy to visualise areas of uncertainty by setting the
alpha to scaled weights. This emphasises data-dense areas of the
lines.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(scaled)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="relation-to-kernel-density-estimates" class="section level2">
<h2>Relation to kernel density estimates</h2>
<p>It may seem pretty trivial, but using the weights as the y position
gives something very similar to kernel density estimates. The defaults
for the bandwidth differ slightly, so we exaggerate the similarity by
setting them equal here.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stage</span>(hwy, <span class="at">after_stat =</span> weight),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                         <span class="at">linetype =</span> <span class="st">&quot;Rolling</span><span class="sc">\n</span><span class="st">Kernel&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                     <span class="at">bw =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(displ, <span class="at">colour =</span> class,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">after_stat</span>(count),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="st">&quot;KDE&quot;</span>),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>               <span class="at">bw =</span> <span class="fl">0.3</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>               <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="rolling-mean" class="section level2">
<h2>Rolling mean</h2>
<p>As a final note on this stat, a rolling mean-equivalent can be
calculated using the <code>&quot;mean&quot;</code> kernel. This is the same as
setting the kernel to <code>&quot;unif&quot;</code>, since it uses the uniform
distribution as kernel. Typically, this is a bit more blocky than using
Gaussian kernels.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="at">kernel =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">bw =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="difference" class="section level1">
<h1>Difference</h1>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Many people who try to illustrate the difference between two lines
might have run into the following problem. In the example below we want
to illustrate the difference between the <code>uempmed</code> and
<code>psavert</code> variables from the <code>economics</code> dataset,
and change the colour of a ribbon depending on which of the variables is
larger. Because the groups are inferred from the fill colour, and there
are small islands where <code>uempmed &gt; psavert</code> is true, the
ribbon will be drawn in an overlapping way. This makes perfect sense for
many visualisations, but is an inconvenience when we just want to plot
the difference.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmin</span>(psavert, uempmed), </span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fu">pmax</span>(psavert, uempmed),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                    <span class="at">fill =</span> uempmed <span class="sc">&gt;</span> psavert),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>To circumvent this inconvenience, <code>stat_difference()</code> uses
run-length encoding to re-assign the groups and adds a <code>sign</code>
variable to keep track which of the two variables is larger. By default,
the <code>fill</code> is populated with the <code>sign</code> variable.
We can control the name of the filled areas by using the
<code>levels</code> argument.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">ymin =</span> psavert, <span class="at">ymax =</span> uempmed),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;More uempmed&quot;</span>, <span class="st">&quot;More psavert&quot;</span>),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">alpha  =</span> <span class="fl">0.8</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="interpolation" class="section level2">
<h2>Interpolation</h2>
<p>An additional nicety of <code>stat_difference()</code> is that it
interpolates the cross-over points of lines. It’s not very visible in
the densely populated graph above, but we can generate some dummy data
to show what we mean.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">2.5</span>), <span class="at">ymax =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymin)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymax))</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ymax <span class="sc">&lt;</span> ymin)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Plain ribbon&quot;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;stat_difference()&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><img role="img" src="data:image/png;base64,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" /></p>
</div>
</div>
<div id="function-x-y" class="section level1">
<h1>Function X, Y</h1>
<p>Sometimes, you just want to calculate a simple function on the x- and
y-positions of your data by group. That is where
<code>stat_funxy()</code> comes in. It takes two functions as arguments,
one to be applied to the x-coordinates and one to be applied to the
y-coordinates. The primary limitation of this stat is that you cannot
use functions that are supposed to work on the x- and y-positions
simultaneously.</p>
<p>For example, it is pretty easy to combine <code>range</code> and
<code>mean</code> to construct range indicators.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="fu">stat_funxy</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group),</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>             <span class="at">funx =</span> range, <span class="at">funy =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">&quot;both&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div id="centroids-and-midpoints" class="section level2">
<h2>Centroids and midpoints</h2>
<p>There are also two variations on <code>stat_funxy()</code> and that
are <code>stat_centroid()</code> and <code>stat_midpoint()</code>. While
the default function arguments in <code>stat_funxy()</code> do nothing,
the default for <code>stat_centroid()</code> is to take the means of x-
and y-positions and <code>stat_midpoint()</code> takes the mean of the
range. Under the hood, these are still <code>stat_funxy()</code>, but
have default functions. The centroid and midpoint stats are convenient
to label groups, for example.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Centroid&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">stat_midpoint</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Midpoint&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;limegreen&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cropping-data" class="section level2">
<h2>Cropping data</h2>
<p>While for the general case the data should be cropped to the lengths
of the function outputs, you can change this behaviour by setting
<code>crop_other = FALSE</code>. This might be convenient when you might
have other aesthetics that you care about, in the same group. Not
cropping other data probably only makes sense if the functions you
provide return a single summary statistic though.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">xend =</span> waiting, <span class="at">yend =</span> eruptions, <span class="at">colour =</span> group),</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="at">crop_other =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="run-length-encoding" class="section level1">
<h1>Run length encoding</h1>
<p>Run length encoding (RLE) is useful as a data compression mechanism,
but can also be useful in plotting to check if subsequent conditions are
being fulfilled. The default behaviour of <code>stat_rle()</code> is to
draw rectangles in the regions where a series of values (a run) have the
same value. Let’s say I have the following series:</p>
<blockquote>
<p>A-A-A-A-B-B-B-C-C-D</p>
</blockquote>
<p>This series can be compacted by run length encoding, but can also be
useful to extract the following properties:</p>
<table>
<thead>
<tr class="header">
<th align="right">run_id</th>
<th align="left">run_value</th>
<th align="right">run_length</th>
<th align="right">start_id</th>
<th align="right">end_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div id="examples-1" class="section level2">
<h2>Examples</h2>
<p>In the example below, we’ll use the <code>cut()</code> function to
divide the y-values into three bins, and use the <code>stat_rle()</code>
to draw rectangles where datapoints fall into these bins.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">cos</span>(df<span class="sc">$</span>x)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: y.</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; ℹ This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;   the data.</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; ℹ Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This can be made slightly more pleasing by closing gaps between
rectangles.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>)),</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>           <span class="at">align =</span> <span class="st">&quot;center&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: y.</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; ℹ This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt;   the data.</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; ℹ Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="using-computed-variables" class="section level2">
<h2>Using computed variables</h2>
<p>An alternative use case of <code>stat_rle()</code> is to use the
computed variables to describe a series of data. For example, if we’d
like to summarise the above graph in just it’s runs, we might be
interested in what order the runs are and how long the runs are. If we
make use of ggplot2’s <code>after_stat()</code> and <code>stage()</code>
functions, we can grab this information from the stat.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="fu">stage</span>(x, <span class="at">after_stat =</span> run_id),</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>               <span class="fu">after_stat</span>(runlength),</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>               <span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>),</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">after_stat</span>(runvalue)),</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>           <span class="at">geom =</span> <span class="st">&quot;col&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAA21BMVEUAAAAAADoAAGYAOpAAZrYAujgzMzM6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQkDqQkGaQkLaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2Zma225C2///Ijk3I///bkDrb/7bb/9vb///kq27k///r6+v4dm3/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///8uXWDaAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKGUlEQVR4nO2di3rbthmGacedk1ppO2VVstXeWrttZjdr7dauujiZokmyeP9XNAA8awBBQIA+Svze52kpSyKl/K9wIn6QSUqgJOgvMHQoAAwFgKEAMBQAhgLAOAr4qEH7pO8r8Q8WJ47eUAAYCgBDAWAoAAwFgKEAMBQApkXA4vVodJmmj6PR6Ivf8+cwMQt6sJ2EtTtmAau/36aLN7fpw2XtSUzMgh4sfkydMAv49JX438Pl+qfb2pOYmAU9WPSQutHeBohSsLoYqZooTf8k2Oaj/qNnm0MeAK0C1jfnqhaqSsE2P02DgK1/54dbAlYX5/mjsh3YJjIUoKO1F1Q2vxQQDbOAPP6fvvyQrt+F6IZSgA6zANn/l82v2L4sO0LbRIYCdOxwJEwBOigATL8F/NkABVBAKCgADAWAoQAwFACGAsBQABgKAEMBYCgADAWAoQAwO1ygYRDQtotJwK6+8g5gCQBDAWAoAAwFgKEAMBQAhgLAUAAYCgBDAWAoAAwFgKEAMBQAhgLAUAAYCgBjXym/uhh9+aF4jgJCY10pv765TB+/Kp6kgNBYV8qv/vF7uvgraJHeoAVIRClYfPNBFQbISnmTgG2+Rs+wrpSXy1QzARKWgNBYV8pXJUBCAaGxrpRnGxAX60p5WQ2xFxQP+0p5jgOiwpEwGAoAQwFgKAAMBYChADAUAIYCwFAAGAoAQwFgKADM4QmwfUycOHpDAWAoAAwFgDm8SxV4fAwSloDuzJ9f++9sggK6QwEUcLgC5i++T45/kxEWYZ4/f3uaJJOnqzPxyvT4fi7+Ss6yV7J3pE9XSXJ8v3X4KaBgfnqS/8RlmE+fvZeBn4qNsLAcTzIPlYCnK/F2+TIFBBMwqQuYpMXvXfz3Xxnn7M/iHTP561ditoUCMsq6JW38zs+yn/lMVEFHdQHTRHFGAVEFpLNn/xYOluOj640SEKT2UVBAhl7A8tXbF/dCgywEjRIg/to+9goKyFCRXY7PRKN7VAlI75ITFXvRRqini3c8XQkpQSxQQE1AKvubX7+qCZglsp29Ey3AP8cT1SZn71Dd0CClgALAUACYhgA14msd4VFAaOoC1PCuHQoITV1Ah5EdBYSmWQIoYOc02oDZRu2vFufJpUpf7NEivX0VsBwnBYWGTyrw5b2EJQcrwPQviE5LN/Th5c+iBFS3M5ccrADDTkFjrUXTCFcVkayCVhdqrWS6N5cq8PgY4159ELB4c1srBSwBoakETMs2oBwNlCvkUfeUH5QAzTiAAkKH+/9pPRckBcirpazfHXw3tBcCqp5oXgkV44CXZUeIAkLTKAHTbKr5zHxSiAJCo+8FbQ6JSwYrYFrMv89fVKERVUY+NzzLhq/1zdNV0iVpggI6CZh/nk/Cz2on6+W5s+lJYUU8am7SO1cBZRVkTjkaqoAilndHb6sSsPzLfa1A5I9qG3cBKv9FFJypcbZzoAJkqJtxVg9FsVi+KkKVlYX6xkOAlYEKKGughgCZrlIIkFkTmxsKCCZAhvou653nAuRfzRKQP6pt3AUMeE7YpwQ024Ai3tXGWcCQ54TbBejbAJU6qkKWV0bNjbuAIc8JtwuoxVIKKCRk4wDV68zStJobjxJAAQYBtTpI8munpRnubYBx/FUyVAHVSFjy9GOHyHqNhJPOjXCEyPRaQDR8u6EUEAgKyOiJANF8T1oXfxysgI96AkbaQEPA3bM/xpMOo4HUmK/QtoshMh6fEiEr4jMtu58PkEOBtr7QwZYACqCAVK48/kM6aFl8SQGh0cwHtC1+pYDQsBuaQQGDF6BJT9dAAaFhCciwCchPxrUmotjfoTlBRwGdBOSno22JKB6pKr5TkgMTkMfNlojikariOyU5LAHFlKQtEcUjVcV3SnJYAooJMVsiikeqiu+U5LAEFGkptkSUzRLQIVXFd0pyWAKKEmBLRPFIVeGUZBcBRRtgS0TxSFVhN7SLgDJu7Yko8nnXVBUK6CRgIy3FhD1dxa0KUkuU9HdTHZiAZlqKCWu6SqeRcNWGq0sVrG8udfcTHpqAaGiqoFl+LiO7VIHhjtoUEAidgOZK+fKe8o1LFRgi0/ZRhsi07WISEPhj0n4JuCvzUop1wpkAycGWgI96YoS8iaYRrtYnNUtA43tSQCCsK+UH0gYYPidwtDW0nguSgV/fnA+hF9QLAfqLdQxjHNALAR3uSEABoeHJuIxeCOgABYSGAjIooOcCpmcdUlLUvHvHtWEU4CRg/vl7e0pKcS2VTqsjKcBJgIipPSWluJYKBQQXoIJvTUkpTFBAcAEy+PaUFAqIJkAG356SQgHRBKjgW1NSKCCaABl8e0oKBUQToGJqT0mhgGgCOqSl/LpZO3WDAjIsAuxpKWVKCkfCUQREw1FAiSEybbsYIuPxKRGyIvZFAEtAaChg4x+2cejoUACYXgjQp6V91ibAuAsFUIATFACGAsBQABgKAEMBYCgADAWACS/AGBoK0EEBYCgADAWAoQAwdgGPo5FcMZ9BAaGxCyhv5iyhgNBYBVT3k5dQQGisAlYXogpShaDjpQoMoWmbLTfuYhLQsovnpDwMq4DFm9taKWAJCE23XlDZDlBAaCgAjFWAvFrK+h27obHoNA54WXaEKCA0HAmDoQAwFACGAsBQABgKAEMBYCgADAWAoQAwFACGAsBQABgKAEMBYCgATPhLFRhCw6wIPSwBYCgADAWAoQAwFACGAsBQABgKAEMBYCgADAWAoQAwFACGAsBQABgKAEMBYOwCXO+mSgFO2FfK31y63U+YApywr5R3vaM2BThhXylf3lO+cakCEohO64QzAZKPGkyXfvd6Jf7BIgfUFYcSIMHELOjBIgfUFd82YKcxC3qwyAF1pUMv6FzXC9ppzIIeLG48nfEdB+w0ZkEPFjWc7viOhHcas6AHixNHbygADAWAoQAwFADGd31AJzzOXPic7NjrEyQUAIYCwFAAmKgCiB0KAEMBYCgADAWAiSdg8Tq/7L0LMgfDdY/ahX33kGgC5DSmvPS9G4/Ozh4u1bT13hJNwCc5i/bgGM7F37513EPOmO41UduAajK/G+uffnGtghbf/ItVkAk5nezE47lzG7B4fakSN/aWiAJWF47xF4F0F9DImtlDYvaCXNtTecey0cjN2uo7CtDjHn+Jezf0gVWQnuzn7N6rd91jdVHd528f4UgYDAWAoQAwFACGAsBQAJjeCpg/v1bb2fE9+JvEpbcCCigADAXEY/7i++T4N1nViPpm/vztaZJMqhfF88txcvQDBURjfnqS1/VSwOmz9+m0irZ4ajk+Ew4oIBrz00ldwKRqeVP1UNU+UwqIRhH7vAq63hQwFWVC1FMUEAsKSPstQFVB7AXFQ4VbtrRPV0c6AcvxCRvhmGThnove59evdALYDSXxoQAwfRMgKyTJ0bX9vQdB3wQMDgoAQwFgKAAMBYChADAUAOZ//XCW2GoaixUAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
