<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Statistics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Statistics</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code></pre></div>
<div id="theoretical-densities" class="section level1">
<h1>Theoretical densities</h1>
<p>One of the more useful tools for inspecting your data is to view the
density of datapoints. There are great ways of doing this, such as
histograms and kernel density estimates (KDEs). However, sometimes you
might wonder how the density of your data compares to the density of a
theoretical distribution, such as a normal or Poisson distribution. The
<code>stat_theodensity()</code> function estimates the necessary
parameters for a range of distributions and calculates the probability
density for continuous distributions or probability mass for discrete
distributions. The function uses maximum likelihood procedures through
the <strong>fitdistrplus</strong> package.</p>
<div id="continuous-distributions" class="section level2">
<h2>Continuous distributions</h2>
<p>Plotting continuous distributions is straightforward enough. You just
tell <code>stat_theodensity()</code> what distribution you’d like to
fit. It automatically performs the fitting for groups separately, as
shown in the example below where we artificially split up the faithful
data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can compare this to kernel density estimates, which are more
empirical.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Theoretical&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Kernel Estimates&quot;</span>), </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There are a few tricky distributions for which there exist no
sensible starting values, such as the Student t-distribution and the
F-distribution. You would have to provide a sensible-ish starting value
for the degrees of freedom for these.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>tdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">2</span>), <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">4</span>)),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">ggplot</span>(tdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;t&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">3</span>))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>fdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">4</span>, <span class="at">df2 =</span> <span class="dv">8</span>), <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">8</span>, <span class="at">df2 =</span> <span class="dv">16</span>)),</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">ggplot</span>(fdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;f&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA2FBMVEUAAAAAADoAAGYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOpBmZmZmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T///+iCkj4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIo0lEQVR4nO3dDV/UNhwH8IJ0iKAOt4Gbugdw06F78AbexLPHHRx9/+9oTZs0SZP2n/Ru14f8fh9RuHA2/ZKkvZRcoxRpTNR1BfoeABEBEBEAEWkAunt19PRz/tny9OjJxy1VqG+pB7p/d5Zef80+u/vxQ3rNrYJLPdDdTx/T5fes4SxffM6/KjIrIv41Ulfg+/g6T9gKUM6StR21BX2VZYMbH0LqgW6eCiBlNErRgsrIFrR8/iG9eYIuVokcg5S2BCCZ+3cv+VEMLcieYuRhjejm6OixaEAAorLp/QLQ+vvr/QQAEQUAIgr6AxTHa+8XgNbfX+8nAIgoABBRACCioEdAM0MIQGptANQMFM8ABCAAAQhA1QIAEQUAIgoARBQAiCjoE5AhBCClNgAiEvOPEQctCEAAMgsARBQAiCgAEFEAIKKgL0AJgAC0DlCCLgYgAAEIQJYCABEFvQKqCgGorE12GpTMAAQgAAEIQJUCABEFACIKAEQUbAdIrlS9f2ddLxY4kFw3n16d5csyAaRFrlmVa+YNICYUKpCy6vnFn7yL6evmkzj7GPvFeZd188vTs5yriPxxoQWVLci6LDx/MR8wkDIG/QIgS+S6eXYUs3QxAVQRCgZIWTeffSbfP6isTfBANSlrAyAAAQhAALIWAIgoABBRACCiAEBEQY+AzBdjABK1ARCAALQdIF0IQKI2AAIQgAAEIGsBgIiCngAVLtUTIQCJ2gCISFJclB/51Xm0IAAByCwAEFEAIKKgpuq3x9HO24PLxcFv0e7l6jyK9tJ08fAi/2vx8E0UPfgUNNDt8WH2sXu52M9gVud7+UcJtM/M9oIGmu9epumUAZ3wL7K/JNAJb07hAk1ZD1ocFCbz/AvWtS7kv7fHJwAC0Kyxi4leNd+5sHSxg8smoNvjHaMLjgmoHKSZiRik2YOr8x3HQXpiPdLZgfiKVWO+o79A+WH+DQdK+WE+XexH0XfPisO86WN0sez/iA7HCsQyr2kBlgOYFagg2jW6Yj1QtY/1F4gNO7Ze5AU0zdvZpKGjiToMD4jtnK0XuQOxbpkf5+YNTUjUYYBAbaIfxZq6FoDEaVJT8wEQgGqB2AhWpG4cCxzI+kpkVEBf7HEHcouoQ2hAWfNhp4gsYx2D0ILkZ1sBUu/wzNaI1wHNkmCAim7Ge5iybj5Nr48agVShMQNN9tiU7bQ4zMs1q2m6/OFnAOUNiL3Y5SeKylrn+/d/F11MXTeflJfkh3J1fhNAbH6NAyn3CL9+SYxBgbSg1fkhmzKZFF1MWzcfBNDtM8uMhzYGLfazlxliLkiOQddHLC9HDzT/1jKX6rRunjzMjwJo9fr3b7wuPct186MBSowoQItHnybmi9FqF2vxUmNAQI0taJodn5ov+9ROaBNA+qn0UIHYfLOlbWxgumMkQFkPy06VGy89r85DBpqynTf7mDYGEZOtowZa/cr23TwV0rtYq/mgcQDVZQPzQQACUJlpFJ1Mid/vEHUIEWjy4N9ixgNAVqB8uuPE+8Jh5VQaQLwOAQKlU9bF2JwZgOxA6ZydBjX72IC0QWjUQC4RdQAQgDQg8TqjzUuNIIBYpoyGmvQQdQgQqOUvUM0AFARQMd/cvFaDdzHv86BxALF1GuYvA1vOg4hpRVEH7QWY8sWggVavm4F8kqgX5JMhXJ3/8iU2Um1Bj6pTGZs5DxpFC8rHIGOuB0B6FzOuWwBIAzKv+wBIA2q+qhE4kMN5UNBANQHQ/wek/u4vgAC0HtAsAdDwgVoFQNsCKgchAPE6AAhAANoikBylAcTrACAAAQhAfQIShzEA8ToACEAEkFw3vzw9siwL14HKQSgYILlunq1cXT6v3so4eCC5ZvWGMV2JJiTqEDyQfo/w4jNt3Xzlanz165HE5X7zabHCl0f8kNCClBZ096r0EbXQ39EkfyRutV+DBVLeu2N5eiYfFxzBA8l185oPgMqU6+aLd16oHMUAVBfBASBfoBmAAAQgAHUJVIzSAOIaJtAMQAACEIC6BMofAlARABFAKYAABKDtAyUAAtA6QOwxAInaWIESAJW1ARCANg+UCQUPJGK/FJ8BjSvtW5C1AWUtKNl8g/B+Qp+BZgDidQBQK6D6PgagInEKoKIO9UB2IQDx1I1CAOKJZ3YhAPEAiNehDigrsI5CAFIKbEIAKgvsnQxAZTXtTQhAZTVjqxCAZDVZEYCagHKhxHi87f56P6HvQMVkY0UIQGo1LUIAUqsZm0IA0qophJLK46321/sJAwAS1zykEIAq1YxLomTd/fV+wiCASiFOBCCjmrFK5H1Bsf9Act28eud5DyCVqEDymQbpPZBcN6/deb4cYhz3KxZI7HFx+9dRAMk1q+qd572BuFEcG61JySCBtLuFW9bN+8d8R/lNp33dauOybl5bQZ8aP641f/CD7WK2FgQgJcQYBCC5bl678zyAysj7zVvPgza1X8MFqsmm9wtA6++v9xMARBQAiCgAEFHQKRCP90uOHj7BJQAiAiAiACLSfilCIAEQEQARARARABFpB6TNf7iEvdPgk4/094nk83M+W8mf4LsVl7QC0q8DueTqjP4eJTdsP322kj/BdytOaQWkz8E65P79B/qbZK4e/8Wm6dy3UjzBcytuaQWkz+I7JOssynuau2wh21+vrfCJT7+tuKQVkH4dyCHs/cy9fr5sf722kov6bsUl22lBeXxGiFYtyHsrLtnOGJTHF8hrK/0C0q8DOYT1lvs/PA/zXlsRfdJrKy7Z3nnQY58u2fo8yGsrLsGZNBEAEQEQEQARARARABEBEBEAEQEQka6BpjsX6e3xYce1aEjXQOlkj/3pbzoHWjx8e3DZdSUa0jlQOo1Ouq5CU7oHmkR97mHdA813/znucxPqGug205nv9ngQ6hpo8uBTujrvcSfrGqj3ARARABEBEBEAEQEQEQARARARABEBEJH/ABTjhtW3iAYSAAAAAElFTkSuQmCC" /></p>
</div>
<div id="discrete-distributions" class="section level2">
<h2>Discrete distributions</h2>
<p>The way <code>stat_theodensity()</code> handles discrete
distributions is similar to how it handles continuous distributions. The
main difference is that discrete distributions require whole number or
integer input.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="dv">5</span>), <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="at">mu =</span> <span class="dv">5</span>)),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>incorrect <span class="ot">&lt;-</span> correct</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># Change a number to non-integer</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>incorrect<span class="sc">$</span>x[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">ggplot</span>(incorrect, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; Error in `stat_theodensity()`:</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; ! Problem while computing stat.</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; ℹ Error occurred in the 1st layer.</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Caused by error in `setup_params()`:</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; ! A discrete &#39;nbinom&#39; distribution cannot be fitted to continuous data.</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A practical difference can be seen above: using simple lines are not
very appropriate for discrete distributions, as they imply a continuity
that is not there.</p>
<p>Instead, one can work with centred steps:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or perhaps most appropriately, you can display the distributions as
probability masses through lollipops.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>))</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Warning in stat_theodensity(distri = &quot;nbinom&quot;, geom = &quot;point&quot;, aes(xend =</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; after_stat(x), : Ignoring unknown aesthetics: xend and yend</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="comparing-different-distributions" class="section level2">
<h2>Comparing different distributions</h2>
<p>Let’s say we are given the task of comparing how well different
distributions fit the same data. While we can use more qualitative
methods, having a look at the distributions is still a useful tool.
We’ll generate some data and see how it works. We’ll fit a normal and
Cauchy distribution to the data and plot their densities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">5</span>, <span class="fl">0.2</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From this it is quite hard to see what distribution more
appropriately fits the data. To get a clearer view, we can use a
histogram instead of a rug plot. The problem though is that by default,
histograms work with count data, whereas densities are integrated to sum
to 1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There are two possible solutions to this:</p>
<ol style="list-style-type: decimal">
<li>Scale the histogram to densities.</li>
<li>Scale the densities to counts.</li>
</ol>
<p>A nice thing that ggplot2 provides is access to computed variables
with the <code>after_stat()</code> function. Luckily, one of the
computed variables in histograms already is the density.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we can see that probably the Cauchy distribution fits better than
the normal distribution.</p>
<p>Alternatively, you can also scale the densities to counts. To do
this, we must know the binwidth of the histogram. Since different layers
in ggplot2 don’t communicate, we have to set these manually. Just like
histograms provide the density as computed variable, so too does
<code>stat_theodensity()</code> provide a count computed variable, which
is the density multiplied by the number of observations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>binwidth <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> binwidth) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rolling-kernels" class="section level1">
<h1>Rolling kernels</h1>
<p>A rolling kernel is a method that generates a trend line that doesn’t
require specifying a model, but is also very bad at extrapolating. It is
similar to a rolling window, but data does not need to be equally
spaced. An attempt at illustrating the concept you’ll find below.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For every position on the x-axis, a kernel (above: Gaussian kernel in
blue and green) determines the weight of datapoints based on their
distance on the x-axis to the position being measured. Then, a weighted
mean is calculated that determines the values on the y-axis (red
dots).</p>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>Below is an example for a Gaussian kernel on the <code>mpg</code>
dataset.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is pretty easy to visualise areas of uncertainty by setting the
alpha to scaled weights. This emphasises data-dense areas of the
lines.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(scaled)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="relation-to-kernel-density-estimates" class="section level2">
<h2>Relation to kernel density estimates</h2>
<p>It may seem pretty trivial, but using the weights as the y position
gives something very similar to kernel density estimates. The defaults
for the bandwidth differ slightly, so we exaggerate the similarity by
setting them equal here.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stage</span>(hwy, <span class="at">after_stat =</span> weight),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                         <span class="at">linetype =</span> <span class="st">&quot;Rolling</span><span class="sc">\n</span><span class="st">Kernel&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                     <span class="at">bw =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(displ, <span class="at">colour =</span> class,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">after_stat</span>(count),</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="st">&quot;KDE&quot;</span>),</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>               <span class="at">bw =</span> <span class="fl">0.3</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>               <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="rolling-mean" class="section level2">
<h2>Rolling mean</h2>
<p>As a final note on this stat, a rolling mean-equivalent can be
calculated using the <code>&quot;mean&quot;</code> kernel. This is the same as
setting the kernel to <code>&quot;unif&quot;</code>, since it uses the uniform
distribution as kernel. Typically, this is a bit more blocky than using
Gaussian kernels.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="at">kernel =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">bw =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="difference" class="section level1">
<h1>Difference</h1>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Many people who try to illustrate the difference between two lines
might have run into the following problem. In the example below we want
to illustrate the difference between the <code>uempmed</code> and
<code>psavert</code> variables from the <code>economics</code> dataset,
and change the colour of a ribbon depending on which of the variables is
larger. Because the groups are inferred from the fill colour, and there
are small islands where <code>uempmed &gt; psavert</code> is true, the
ribbon will be drawn in an overlapping way. This makes perfect sense for
many visualisations, but is an inconvenience when we just want to plot
the difference.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmin</span>(psavert, uempmed), </span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fu">pmax</span>(psavert, uempmed),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                    <span class="at">fill =</span> uempmed <span class="sc">&gt;</span> psavert),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To circumvent this inconvenience, <code>stat_difference()</code> uses
run-length encoding to re-assign the groups and adds a <code>sign</code>
variable to keep track which of the two variables is larger. By default,
the <code>fill</code> is populated with the <code>sign</code> variable.
We can control the name of the filled areas by using the
<code>levels</code> argument.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">ymin =</span> psavert, <span class="at">ymax =</span> uempmed),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;More uempmed&quot;</span>, <span class="st">&quot;More psavert&quot;</span>),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="at">alpha  =</span> <span class="fl">0.8</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="interpolation" class="section level2">
<h2>Interpolation</h2>
<p>An additional nicety of <code>stat_difference()</code> is that it
interpolates the cross-over points of lines. It’s not very visible in
the densely populated graph above, but we can generate some dummy data
to show what we mean.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">2.5</span>), <span class="at">ymax =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymin)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymax))</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ymax <span class="sc">&lt;</span> ymin)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Plain ribbon&quot;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;stat_difference()&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
</div>
<div id="function-x-y" class="section level1">
<h1>Function X, Y</h1>
<p>Sometimes, you just want to calculate a simple function on the x- and
y-positions of your data by group. That is where
<code>stat_funxy()</code> comes in. It takes two functions as arguments,
one to be applied to the x-coordinates and one to be applied to the
y-coordinates. The primary limitation of this stat is that you cannot
use functions that are supposed to work on the x- and y-positions
simultaneously.</p>
<p>For example, it is pretty easy to combine <code>range</code> and
<code>mean</code> to construct range indicators.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="fu">stat_funxy</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group),</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>             <span class="at">funx =</span> range, <span class="at">funy =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">&quot;both&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="centroids-and-midpoints" class="section level2">
<h2>Centroids and midpoints</h2>
<p>There are also two variations on <code>stat_funxy()</code> and that
are <code>stat_centroid()</code> and <code>stat_midpoint()</code>. While
the default function arguments in <code>stat_funxy()</code> do nothing,
the default for <code>stat_centroid()</code> is to take the means of x-
and y-positions and <code>stat_midpoint()</code> takes the mean of the
range. Under the hood, these are still <code>stat_funxy()</code>, but
have default functions. The centroid and midpoint stats are convenient
to label groups, for example.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Centroid&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">stat_midpoint</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Midpoint&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;limegreen&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cropping-data" class="section level2">
<h2>Cropping data</h2>
<p>While for the general case the data should be cropped to the lengths
of the function outputs, you can change this behaviour by setting
<code>crop_other = FALSE</code>. This might be convenient when you might
have other aesthetics that you care about, in the same group. Not
cropping other data probably only makes sense if the functions you
provide return a single summary statistic though.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">xend =</span> waiting, <span class="at">yend =</span> eruptions, <span class="at">colour =</span> group),</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="at">crop_other =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAA/1BMVEUAAAAAADoAAGYAOmYAOpAAZmYAZpAAZrYAv8QzMzM6AAA6ADo6AGY6Ojo6OpA6ZrY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOjpmZgBmkJBmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq8huq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQZgCQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2r5OSr5P+2ZgC2Zjq225C22/+2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+L9g2BAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAU5ElEQVR4nO2dC2PctpGA167vhDpuKuXh+B5V2kuTtmeldU5O76z2KluxjYOsVrLE//9bjngMMACHJMglCe5qJrFEDmdJ7HzA4EloU7EUlU3pBNx3YQCFhQEUFgZQWBhAYWEAhSUXgCSEVNLaeUwXehYDKPwsBlD4WQyg8LMYQOFnMYDCz2IAhZ/FAAo/iwEUfhYDKPwsBrD8szYbfM4AGMB6AUSumupZSkXnDGBhACo5LwTg3dHR0edv1g5AqhTC1s9SqVUhAK+fo5NhTlnI1GrVtACUWkkr6O7HV7sCIM6z/TfwwAhTtZpm6Mfv6hBkCsHPa5k1EduJcv/yZdP6rdWwG00g7QCuf/0KlYKBuXIZU6dNikD/DRSlDBdWUgKM+HpgqFMWMR0JQFFKdIEBDNWqPAAQ+hVdB/jG/0oAfPjifXX35/U3Q2VaBPoAKLoSbi0XJfsBn/mG0JauKgGg0ThV2NhcDXdVHQRLAYhkS1fNCyCOQRhAgAAAAFYMoLMdywB6tYqMICoGEPnf/oQSFPd9GcBgbSsA1OI0oT/2f2hFdT6LAfRrUQzymT7yfwDgr8HnU/8zgMHazUaFtmULAOUoQSCCz6uG/xlAthaqWQ0gcrw51j98e0dVhP+hYojvyACytb6do32rUHgBAKG9o+wsS+x/A65xRwYwQAthRqlG6FFQMdjzqun/5mSOwm2j8BQG0FoCPABdBzjPAgComFWThzNMRv6hDDGAXK0LMq4IKBqA41MpsHOikpH/cIUB5GpN64cCAJpw6s5w9o9CEA9FDDBF3VvvVuVrVNf4Uc7FtnJQqkL+r7UqulGyCiJ9NgNoBRDalgp71Wd5ByDJ/44V1AFpV4AB9GpDR0oBAQ8gijlQClQYDdVKqA0qSfXEGEC/NrRXFDQvGwCgIjAXVIX8D3ewZaM3BQyA0IYWuwoe9yHI+Ny51+hVWG3lsz/VESOfxQBIrQKta+ErRyABoEKUMsaoLRr3A6Kpg/jZDIDUQjveBSHtdAgu9tj9U2hiQLn6Wjb7AQxgsKmpWXU+Nw0fBMAeQ7lwVbQM2d/Hfn9Xxf2AMaaqCqOhEQCFC4DpL9vOgAy1Arpr5H3iWQygVWuzNAxHKwVDo46APTB4wmioQv7mZugo0zDbXuGBH5UAMIFGucrBMII6Idw1zfxkChiAbAcAY20KAo90fve1soLpmob7Se8TKWAAMgUA0dz2A6JM72plm+ndP321Styv0lZQewpWAWBNUnvVLGNWdpWzXR2tXaz9bY4TAMpd9kuf1fKroNtkF0uAhJEfGFQz7Rzlqt5wGMQFKfhw68g/rWUAhNY1bdAAaACAxPfIwowxCkPN98vIZzEAWgutfXMMI88UAGMXOs3hBgxgS1OEQEkI9wkAqHorCW0k/1EuAVt3xCqI8NL3uVIALtND3odoZXQeQPdbfgygU5uG/rQKlsbGTR1EtmEoggGMMw1jOditae7HeCSukDGirmcxgD6tq2qTvA81sne+9zbYczN0vKkfirAnMPCvUMMHNUGT2qHrPWFCywAIrXVzhWZacOTxPeFIGwWc+P2ZzmcxgFat96w7idwdAfCzjzGnrGcxAKRtvPhlRCUS+z6VocliABIDINwbh33S1dskiwH0aaPBT4RlomcxgD6tn5Rv1LvtSx0GPIsBdGlhGVAUgnyj0w9FMIA5TC0AopqFphFSMYAZTO0QZ9oBC6q4J6z6Bx1oLQNo0WJXNwD4EaIwFuRHIAY+iwEQWt8T9g7HAPzEjH8TQMXRatCzGECqBc+Gho+MS4Bbqu4mZMJnZFIUGMBwU5SDfcszlIM4Ckn4KX2DyQgsHTJW/RuPMgCvxfFDoXEglVTEeCLMISBuC7Z9KWAAOM/ac+txGapbtApRwVSwMwwLo6lnJdUylQIGAPUnnKF4Y5fJuTogjUTW2FbEVccq0CQUMYBY3FpDOA0zLdI3bVxGV2hRllTwprx9nbvqWQfdMWrBAFB7xWV6G398CHH53b8Z4Bfo2s+4dzmaCNbeCrp76bePntqro0whZ0vYHKVC/ocXYmBxLtqfSQXXxwjWDuDd0ZoAKFgTHaILjvhSQl3giofbyMDaJW9JDkpWMQDX//GHtQDwy8yle83CaKEp5FfqusgPvzyo8CqZ+9igZJUCcPfj/7xcyebdZt25WXtu15k7Law6NwvQ9Vp1qzC/4MDdQV8Ne3avZ3V658at366jDlBo0CDk/pD/YcTHV8HJf+RtFbk3Fp2CQgCuv3m/BgB4PsUGetBb/6N382BXAvyfJ9AczctOViEA+i+YHB19WxYAHrdUqDHjTipYlCVjABD/0TvyWySrEICqeDMU9X3DsBtcMlcr8LdvanoAoQhEi+jGJOueAoha7PFyIMje0o8ESbRHCgJgfuwwACQTeTXXtDFChk0j/8PQv0QAUEvUVxoMYIApMW6GR22ch00d4Oe8ZArA/9jhOqAIgObwcGyK/G+6t27Y2b8fBsHI/+AQlG1q+rrdpjDm4PcfAP9LP+wP/8Nm6Qwg2zQa9yRNYcQt2hNLRgD8rol+t3q1ZbKWA3Dz9Pjm6ebheSkAvaZhPC6MhpoTMFN+YxpUFKTaLlnLATg7qC4enl8crBUAjMWZY6PFJzKMWiwCoM6rD354cn715E91nr092Wxqv119cmp+XH3yYrN59HYggLoA3J4cVJdUERif/MlMYf7XnPvh6HAiAwAbhhTaxXV6ADdPD+t/D8+vHteO137T/zyAx5oJlZN7AOi7rhRAaNZIcDlMVLYAkL5CkOSqiO0AGDddaADH7qT+EQAcu+IwBMDtyeHlg1MdiFYIwE+5aHEeh/fDvJWvxVHt644mB3ChI8zVE+vzS3OiQ89p+F1n6GEAqqvHdRw7I0PX+ORPYuqngt2Z/SWTAtAOQE6/OnoOAB0yPvlTmEI8j/zv+wwqtnMAkiIwTwiCqKMjRzMEPaHak7sIQDn/pf6XSOuOQh2QFoHxyaI94ith7XOohLXy9uTByEpYhyAta6uElQvhif9lNgCj7R7g6NK2uE43Q184AJVrhhoX/vtXthma4/+kEm7/SLb/JgegfOPenXu9RFjcJdzinxuAlsuWtn5WA6gBoKvSyPbf1AAUjCSk/pcZAJB14y9W5Serxfd12G/NsuMA3J6sDwC0dCrK/6hcxEpvOyOA6mLTHmXGAaC7YCUBhDn1xP+uJsgGYGrxJoGVjQXVtcq6KuGwBiX9YyNpYHLaxt+ojffEahBYGYAuyfbfhABUFEFk0/8JACUZQJt2jCn2v21b+hEIIJECSO6KL1apIj9ZCwLQ9crmcBUAVOR/37jXEpY9x23LfgApgbUBuNDRX3fmygOIG/HNtpGzLQjg/2jZBoDrB6xhOFrhAQerJYJN4s8MAMknGECLMryRROZ11TjAZ50AMvawKQegKwQtKUr5heRhv3N8nVKmZy2qTW6ro1fmALCOSjgaW4CDqHtGakNhISy3StaCANplfPKHmpL+p71K/x0wBrCNKV6YhUM9FdjjecZdB2DXBJUdiogXZkVVbT8A6q67BKBHxid/gGk0khA3dZpY4nLRcldFagcmazEA62mGyvYu044AsPPBes7eTwzTU8TrBIB2JvDDbvgMjnYAQPhAH4CLDUj5dUH4j71HpkkTaQcA6IO6cv3Zv5xePfnXzaYx5bXuKclQElIAuWvOFakdlqw2AKohLQDODvUE5tXjQ2IOeVWVcEOZ7mCikiuDbzAqWW0AOksALDCpAdw8O69uvz/VKJphiOgJk8VgfPInNM2bUFkHAFQCrj59mwlgRcPRpHY4gElMtwWQXQLW0wqitZmT6qsDAHUAAxhpujWAuhX0z1khyCwxXW0Iyl3XswoAqbQu1KWWpVDDQYt8007T7KWFqwOg140+aFuote5mKNbuLoBO2RkAlP/3DUDx4egOU9L/+wbAYfiKCleLfNMO03sEgF7zvsg3bVf2bGAw6bPKA1hhCLpXAMjXJBf5pq3KlsnHfQPgKmGyybrIN21Tts197RuALlnkm9LK/j1UZk7WYgDW+IqSHLTB5DzJWgxAMiP24ejo8zcrAFD8WYsBsG/fg1z/5k317ksGULQnrCEwgDEAsrYpSAE0xZaA8pt3r1EWAHD99Wev4HhtuXLJZ20DwGwBp1s3+s1haoyhMSl/jCuCj78DAmtzypLPagMgGtIEcGaWolwc1q49ri6Iqa54z7hHP9ldy7y8hr2L1+aUJZ/VBiCjBOj5+JuvTq8+ffuXFwe33xNd3MaWZccwFvThi/dcAuz5eAD6V+33m2d/e/bXJ397RtQL7QD0/vUL1gHU8v65njXQdPsSUJ392y9vv39BrflM+gE/2X37mjL7N91PAK4OqC43thboAVDbzfOOWPPvNTZMxfC7rhrAY7vM2W2Ea9pA5FYoywzG3T8A2bLQaKiglNhUUMpxz2IAhPQBEJRy5LMYACEMYAUAOv5ysqCUY5/FAAjpBiAo5ehnLQRgIlkyBDXiUIUujrkrA8jWMoAVAxCUcotnMQBChKRaQpUk1AyAAaTnew2grWIYr2UAhLQCaCkW22gZQFMEmdcZQHkATV3GwGmPlgEEAW8KMq/LitAxgAUBUEN0gkPQhADAxdkAhOA6YDkAzcwusp3SoWUAWKzbSQDNzC7yndKhZQBYhgAQA5zSoWUAWNoBiDRaiSFO6dAyACweAOH/yHTnVkUsDGCsCPgpyAs2DZvm5XsjpUoArm/r3sIOTsrvCAA3FZMCiOpbIfBFBrAAgKi+FTEbBrAdgHQsR2hFBwCR+J8BTAlAR3cLgPK/NI3TxP88GLclgGiI01SvIgWAWpyN/N8BgLjCAEgt8qnoBoDcb93bNRjHANoSmv5lotjZIgUQDkVcWOw5+SjRLCqUq9qV9wpAUgQSAP4o8qnQhi27Qohhg9T3D0CUlY0TsbvbANRu9TcQ1owC4DAxgJ6EegQulnu9/a9CCmcWBuOc+0VjNBQFHgbQm1DvqngZohCuFMRWIbPryCMQwcp/cGT/+L4CCDk4ImAA+FpCRLaVvawbq8krStt0z+4tgNCKMS0a0GltAsC5t875Qtp3/PFdyRYPA8hLvnAARJgOhhDvLkvp61uT8xNv081NBpCdfOE7VJ6AEDDeEPzvBilE0hQV6TTZQFfNY7pWAPSggcn9mIANNObQX7E531wB8SgYQD4AuncqYgLaDLVNbYPTAYDPiLQSHumqeUzXCsA2YgTk80iL6wFwtW8cwe46vsEjkruOdtU8pmsGYEdwTDsnascbnwsPwIadKPvbBhNR5zKAYQBEcDJ4VXpNyPDg/2A3aICNAXQk1OdwK6Enazth0iqx/6WL+sOG+HIdeO8AGHGeRRk8NEA1AGF7BK4wNId94rvGVXS+q+Yx3QkAWmy7HjMwGgcAIfL20cfTD49w1TymuwXADiU4P0ZIGi1PqMFjr3MdMBqAEdEpDSKNz/Ok/JYAoqq5TTpMGICX66+PjmDb0GHJ905sZPgYw7b+228Aes/Q618P2TfU/Y1fG2iM71sBIPst/LffAD7ojbszd86NArxVRb6PaPgTBtAJQIvdOTfePX3jPoIzdPwpKrC7H/pqXDbQHe+ldH73u5ffwmHID+A6Kv+4K60AfBcsrEARW3S59r0EfPzO+78/+RB9UCwSbkJe2LkvN24kQtuTK+GeVtDzcNKVUPC997uvhN3wg31HLFS/om8oYivtvgCI/E+l1Hdk7WnU5rHzjS7/C7dXhEDmLTFsmP/2G8C7Iy0drSA0I2b96gGEEWgY+4HJMBERI+ffGQAp7QlFcQXca8OPGwjVdS/M1BsiaO6GYsAAcgG4VSVhhQNq4Dv/uxPoctk62OGR0Aoa7797DwD1ucDV/qUYk/8dGjRAJH2kkqgIjfTfPQfgRn0g3ocwby7CLHC0DDesxzKFxN8VdwYYwDAAAk1xGfe7bO3/JQBCRyzugDGAsQBCGBfR0kTpFyBGDU40EBdq45H+YwASLWyG6FMh77qIEwFAb29UzSqYAQwFENwfv/4er8VCn0cEuBU01TtieJ0nNnXLcGNlsoZL8mDc9gCSpYleWgDEWxWMXwHEAHq0bnEuYZoMxuE4xAAmBkCbplh6xqgZwJjkd2XrZrng9wMWBUBp217Uzr7BTKb3BgBdXQy5wTymuwpAUMqpnDLNDRjAaKdMc4N9BrDE6nIG0KFlAIUBLGHKAMo5ZclnMYDCz2IAhZ/FAAo/axUAWGYSLgH9WgZQ+FkMoPCzGEDhZ60CQL78vN9kF03nEgZQWBhAYWEAhYU7YoWFARQWBlBYGEBhYQCFZUoA+sXWz99UH787+uJ9j+ndy6PPXlU5pvC2bM5dr7/Wz5/adF6ZEoDdWuXu5fPq3Zf9ph++eJ9lWkumqd5a5F2m6XfPc01nlgkB3P1oNhf6+Ps31fVv3nSaaptM08o6Nsf0+pv32i7b9HevMhMwp0wIoC7OOla479Zpev3Nf+sQlGNai86jOaauBOQlwNhkJmBOmRCA3l6rLgV1vOj//l8bUDmmbtOiLFMb0XNMTQj6LCutM8vUraDXzyfPgNpLeeWqzgEfPn+Tdde6Ev7tj3tWAoy8fp5VB/zngBD8Wu9alGPq8nNuYM+sLmaWCQHo73/35zd6m62cVlCd+7JMbd2eY+pKQI6pqS6+zLrrzDJxPyCzca9tcpvhLkTkmH7IT0Btqm32qx/AMkIYQGFhAIWFARQWBlBYGEBhWT+Aq09Oq7//r/m1j7J+AFW1t87XwgAKy7oA3J4cVtXl5riqzg6qq8ebzeaw9v4P9cFhDcEe1Rdvnm4e/PDkvHRqJ5F1AaguHr2tzn5xWJM4vnlau/ri4bnx/KkuBVeP66u15ubpYc3gIQOYQa6enN9+/+LR2/r3P95WJvhgAMdGc6l9f8EA5pA65199+tOzc10S6li02TzAAHRVUP8wF684BM0iZweXB7cnvzrRQebBaVICGMD8cvnoj8fVxT99dVof6UJAlQATgi45BM0iJt9fbmrnX+oC8NgA0PUxAsCV8JxyVvtee7g+qmuA/3p6rN1+tjlAAEwz9AUDKCsmQu2B7CIAHZxuTw5KJ2Ma2UUA1UXdPt0T/+8mgH0SBlBYGEBhYQCFhQEUFgZQWBhAYfl/XZBbjekO2SYAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div id="run-length-encoding" class="section level1">
<h1>Run length encoding</h1>
<p>Run length encoding (RLE) is useful as a data compression mechanism,
but can also be useful in plotting to check if subsequent conditions are
being fulfilled. The default behaviour of <code>stat_rle()</code> is to
draw rectangles in the regions where a series of values (a run) have the
same value. Let’s say I have the following series:</p>
<blockquote>
<p>A-A-A-A-B-B-B-C-C-D</p>
</blockquote>
<p>This series can be compacted by run length encoding, but can also be
useful to extract the following properties:</p>
<table>
<thead>
<tr class="header">
<th align="right">run_id</th>
<th align="left">run_value</th>
<th align="right">run_length</th>
<th align="right">start_id</th>
<th align="right">end_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div id="examples-1" class="section level2">
<h2>Examples</h2>
<p>In the example below, we’ll use the <code>cut()</code> function to
divide the y-values into three bins, and use the <code>stat_rle()</code>
to draw rectangles where datapoints fall into these bins.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">cos</span>(df<span class="sc">$</span>x)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: y</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; ℹ This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;   the data.</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; ℹ Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This can be made slightly more pleasing by closing gaps between
rectangles.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>)),</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>           <span class="at">align =</span> <span class="st">&quot;center&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: y</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; ℹ This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt;   the data.</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; ℹ Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="using-computed-variables" class="section level2">
<h2>Using computed variables</h2>
<p>An alternative use case of <code>stat_rle()</code> is to use the
computed variables to describe a series of data. For example, if we’d
like to summarise the above graph in just it’s runs, we might be
interested in what order the runs are and how long the runs are. If we
make use of ggplot2’s <code>after_stat()</code> and <code>stage()</code>
functions, we can grab this information from the stat.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="fu">stage</span>(x, <span class="at">after_stat =</span> run_id),</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>               <span class="fu">after_stat</span>(runlength),</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>               <span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>),</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">after_stat</span>(runvalue)),</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>           <span class="at">geom =</span> <span class="st">&quot;col&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
