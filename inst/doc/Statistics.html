<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Statistics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Statistics</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code></pre></div>
<div id="theoretical-densities" class="section level1">
<h1>Theoretical densities</h1>
<p>One of the more useful tools for inspecting your data is to view the
density of datapoints. There are great ways of doing this, such as
histograms and kernel density estimates (KDEs). However, sometimes you
might wonder how the density of your data compares to the density of a
theoretical distribution, such as a normal or Poisson distribution. The
<code>stat_theodensity()</code> function estimates the necessary
parameters for a range of distributions and calculates the probability
density for continuous distributions or probability mass for discrete
distributions. The function uses maximum likelihood procedures through
the <strong>fitdistrplus</strong> package.</p>
<div id="continuous-distributions" class="section level2">
<h2>Continuous distributions</h2>
<p>Plotting continuous distributions is straightforward enough. You just
tell <code>stat_theodensity()</code> what distribution youâ€™d like to
fit. It automatically performs the fitting for groups separately, as
shown in the example below where we artificially split up the faithful
data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAA51BMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYAv8QzMzM6AAA6ADo6AGY6OpA6ZrY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOjpmZgBmkJBmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQkDqQkGaQtpCQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zjq225C22/+2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///8mBpEIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAN+klEQVR4nO2dC3/bthXFaS+z4riz0jbJtrpZ22yN01RNtnhdnWhxNDmaX/z+n6cEH7p8ALwgiUuA1jn5WVJ4CT7On3jwASKKIa+KfG/ArgsAPAsAPAsAPAsAPAsAPKs7gJVS9mnUsLDf5M2wgO0kAODDAraTAIAPC9hOAgA+LGA7CQD4sIDtJADgwwK2kwCADwvYTgIAPixgOwkA+LCA7SQA4MMCtpMAgA8L2E4SATBLNMACAGiVxU7M4lUrAQAgSQCYqTAA2AkA+LCA7SQBALMs3EIAAEgAwIcFbCe1Arj624f0+2I+n3/5AQDGBvC5cP39y9JUbidmRdhMAACsALx//M8sB9y9eQcAHgBsi6CbF0kRlGaCh4m4Jc4aP6AW2QC4ev6ulAu4o2ibA8xZADmgG4BU23qA2YkZhQHAQgDAhyX9twLw+atP8d1by2YoADgGoP6S84DH24ZQ+07MSmEAGApAq/adKAMwEgAAEgDwYQHbSQDAhwVsJwEAHxawneQYwKy6EwYCAEACAD4sYDsJAPiwgO0kAODDAraTAIAPC9hOkgVgIAAAJADgwwK2kwCADwvYTnILoPAbAKwFAHxYwHYSAPBhAdtJAMCHBWwnCQPQEwAAEgDwYQHbSU4BbN0GAGsBAB8WsJ0EAHxYwHYSAPBhAdtJ0gC0BACABAB8WMB2kksA5DUAWAsA+LCA7SQA4MMCtpPEAegIAADJ5Wsr9V1i0FGmVcgBfFjAdhIA8GEB20kAwIcFbCcBAB8WsJ0EAHxYwHaSQwAlpwHAWgDAhwVsJ8kD0BAAABIA8GEB20kAwIcFbCcBAB8WsJ3kDkDZZwCwFgDwYQHbSQDAhwVsJ40AoEkAAEgAwIcFbCcBAB8WsJ0EAHxYwHYSAPBhAdtJzgBUXAYAa40BoEEAAEgAwIcFbCcBAB8WsJ0EAHxYwHYSAPBhAdtJAMCHBWwnAQAfFrCdBAB8WMB2EgDwYQHbSQDAhwVsJ1m9Pf3mxfyrT+0Aqh7XwzUCAGAHoBhD5u6Xl/HF1wAwNoDtGDI3//hQGkpAv5UA4B4ADWHy/af45u/q/fXmMWTa+8Ggl4xRtgM4ZACU9IcJcoAgAMoBAFDS9ZNo7+ej883RT9H++e1pFB3E8ebRIv3YPHodRQ8+OgIwvA7gwkMtcpncFsD1k+Pkb/98c5gYf3t6kP5tARwqJgeOANz98gPXCuIO8XsI4HL/PI6XCsBJ/p/kgwCc5NlhMAD1x58H7CCApSphNkeZ55fpf1TRs6Dv6ycnAwFopd3KgAGsEw1bOgB0C1fiqftVBC6LoKLUudxbaIqgo/NuAK6fqMXcKwCF8WUCrith5XlRCauJt6d7vSvhM4u2k3YrAwVQsn2tCVsu3WCEaoa+zgHEeTM03hxG0TdPs2aojf+NIihZanTsHkDrxVILD7qEKV4ueCgPuDwRuzQcr1YNIC2ADMF+S+Gl3cogAVTr3i0BV3VAUl4bS5n+AJZpzjlrKYh0W8lf8PcPYEvAVQ5IrDKWMj0BqIIsbTldtmQB3VYGCWBdn+4YgBtVW0FtRU8h3VaGCKDhf5EFQgbAHv6TBrACAGOYS94lnMU1/ucTQwWg6pRM7e1X3VZOBsC6z9JHAmB57WIiALT+Z5MdAfifXkMA2Em3lRbPnZg70Nh40CU8UQDJ4a9OwZQk6oCRARj8TwOBArCWbisBAAAqcaP/ikDAALJiiDkb02ylTS88ALAAcHagbnIuOzdDpwRgtQ4XQJIB1OW97idiVv1QTa8TsvKgS3gVt/kfOAB1RwcA6lPGAnB7eqwucp+JFEEjAmj1nw27AZDdD1b37Lc3hvW3iCt1wOYwOmi9FwAAnQGU3OUBWEmzlWEBYMuYdgICOSBpWv7hz4vN0V/y2y0A0G3pJgDrhgwAzo7VDczN4bHmHnK9COpzKcLunWThAGgvhBzlgMLKBMD1s/P49tVCoWgWQ9VK2OZBiuZWWr4UTv9ubzsPuoTDAFDKAZsvPtoB6Hs5OiwAFqe6IwPokAN2BEArAYFKOK8DWADcKZhJlh2QxumntHY2E6NuraA/2hVB/e4HBJUD7K43t2QBmTNh44O6LpqhIQGwvOU1KgD1uJXxsWcA4Jc+FECrqgCWyanasuulCNshMkIC0ELA6/2AB//NrkgDQGXKWADSy9EnnS9H2wKgGeUAWD95BQCsRb3C9o++GQn4LIKWqghS92QAoDJlNADxpToNaPc/aAAdnr4NE4CNGls5TQBGAgCwowCK6xDdL0VYA9jOKQWgWxcYAwGvlbCynrso3dhKAHAFoGcHDQDwC0DjPwDYvaagDqAogrqdB4QDoGtHYD0BnwCy8wDmtlh9KzsAKObdIQDpw87qVqPqOazrVz+8GRoMgO7vItASsAcwa6gJ4Cx9FGV5HC+TA3upKVsAgF+6CYBFDlD346+fLjZffPz364PbVwsAWI0LQH0lvl8/++3Zr0e/PdPUC/cHQJ/30egISOSA+Oyvf7p99Vp3o2UwAJ3/AFCrA5LWTVYLAMBqLACHWZf3vMtX2gbSnl/tNgAdgaldDQ0FQL+Xwu0agHxuAAAATTJj6qABaP33AKDvi0EBoFNyc7j3m1kbBGwBOBIA8EsXsJ3UAoBe2X0xn+fDyQwFkM3vHsCaiZvD4QIoDd3z/mVpenUrAUAMAA3bcPfmXWl6dSsnD6BBIBgANHBJUhbN52kmaA7i07Xbi1A3mQFdXlz0lhkgMwAauufq+btSLqgeJmHkgEEDBKzbwwHkgFTbeqC6lV0BpAkAwAZAdegeABgdAA3dowqju7faZqje/7EBsBZ2SR4MgPw8QGWC5Dzg8bYsqmwlAAgCMKiylQAwVPcBAN+SZ8LMWYSA7SQAqC/gvgNQSUIDwFzKE7CdNAyAwX8AsNc9AGBxOY0LA4B98mbYAYD2G5oCtpOmD8DmpiIb3iUASSIAIAFAfSlTAmDyf0wAVk/28GEAsE4uA6Dt4XYB20keAKxmAEACgPqCpgSg6z7mcgnA7gFzmzAA2CYHgN77mMshAMteXlZhYzdvAdtJAFBf1g4AMFfedsmFABhfdiNgO2naAGz7utuFAcAyuRQA0xvnBGwneQEQMwQAoE3D9jELOwJg/cIZyzAAWCYvfrgGYHjvroDtpCkDsH/tnm14ZwAw1bA3APrRBwRsJwFARWvdACgCtpMmDKDDu2/twxMA4EQuOsqIdG0Zvb+MpxzQngU85gDdKGQCtpOmC6DLCAAdwmvNTX5JAUBdOwKglYDN0s3+D9245pN2kgKARhgAbJK3+D8YQONpa0l5A9BGwC+A5uPukpoogDb/h29cvc+ZpABAF65125OUPwAtBDoXEj3W3hoGACa5NIBatz1JTRJAu/9OAFQ6LUnKI4C+j5Yyx7+bjQOAFo0BoDJFUj4B9Otgo7tc1mvt1mEB20lTBMAsHQDsAfToaK+9Z9Vr7dZhAdtJXgH0edOB9rZ5v7XbhgVsJ/kF0P2FWwDgGYD+yZ2ea7cMC9hO8gyg48vXTQ8P9l27XVjAdtK0AJgeIO+7druwgO0k3wA6DcK0BoDYOYAOg7EWZ2AA4HYfmwT0ybdnwADgeB8bBLTJ6QoEALgGUCegS166AgQArvexTkCTvMMIGQDQIzxrj1cvgAKA+32sZoJavH79eVcA0Bgy9EsMQAVBOb5uXv7fEQA0hkxpNBlBAApBfajDtcb+nQFA4wdURxIQ2cdC2cjgcWa96dbXjgCgETToV20MmbWMmmO1e5Co6yWZAdAYMvRLSeQgCyh50DkAAEYE4KUOCCB5MABoDBn6VQMwS/9mqgU5y+vPVVGGpm0a+u9Wq9ILm0otz1l5gorXK+CkRl6rqesslH+pCWllvU7j6+KbtCp9NrRaVWbMl1ysxzOA0hgypvMAABAFYBAAOBUAAAAAdBMAOBUATA5ASbP0L/mXfShlXw+zH9upJcWlN3WUTvhn5Qnqckf9rRnrtZqUf8TFl5qQKL0qkgbV98PyNZK49NlQ+WpKvgaVOl/PKJJ5W8pDfpZgkw9ceVcBgOOVdxUAOF55V3l6YRNUCAA8CwA8CwA8CwA8SwDA1bfz+cv+yT/P519+4GczSz3E0VcX86Fr7yr3ANTNy6vn7/gZ9UrHsP+an8+siwH43w84cvrJPYDPyr1hO0L3P/sk/u7H3iu/e9P7wOkrmTqAbuH30pAccPfmX/2LoJsX80HFZw+JAFA3kfvr6tvHA/Bd/DCgDlBF58i5QALAzYsh/seDMtDV95+GVMJK49YDIq2gwXvQ3wPVjJnPBx0AUwcw0P/qY3h9NCAHqJXfvZ14MzQ7Bgc1xYfUAYPPA4atvLNwJuxZAOBZAOBZAOBZAOBZAOBZEwLw///Em0cL31vhWtMBcA/NVwIAzwoLwO1pFO2fx5ujn6L9X5XhieubR6+j6MHHzWEUHSsIap4DFfk5mXKS/Ei+1PdEFRSA29PE2aUy+yA/4hWAw/1zFVD/T/7Uz/S/hw8+xsv982y2w8kSCArAZXL0x9dPTlI/CcBJnhNSAOk8ycd28tG5780epKAALKNUx4X3W+NTKjmA5MDfTlYfZ2mJNFmFBUCZG5P3VgBUUFUcE1VQAC73Ful3FUBa1hydFwDUPJdF2Z+3jBI+frZ4uIICcHuaHN6Jw/lBf5xM2NtWwsrkciWcA0jrhAk3UYMCkDYx9xa5n6p9+c3TrBmqSvmz6KDSDF1kH5dRmmaqCguAThM+um0EAJ4FAJ4VPoB7LgDwLADwLADwLADwLADwLADwrN8BJLZ3z913w4wAAAAASUVORK5CYII=" /><!-- --></p>
<p>We can compare this to kernel density estimates, which are more
empirical.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(eruptions, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;gamma&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Theoretical&quot;</span>)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&quot;Kernel Estimates&quot;</span>), </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There are a few tricky distributions for which there exist no
sensible starting values, such as the Student t-distribution and the
F-distribution. You would have to provide a sensible-ish starting value
for the degrees of freedom for these.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">2</span>), <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">4</span>)),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;t&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">3</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>fdist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">4</span>, <span class="at">df2 =</span> <span class="dv">8</span>), <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">8</span>, <span class="at">df2 =</span> <span class="dv">16</span>)),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fdist, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;f&quot;</span>, <span class="at">start.arg =</span> <span class="fu">list</span>(<span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOpBmZmZmtrZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+vy8vL4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T///9FiP46AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIGUlEQVR4nO3dC1/aVgAF8PjI1Brb0W3Yre2gWzu7TQYyLQsCYr7/h1puEvIgN/fcxJBcyDm/VXGnAfx78yCYW8tjlLHafgKmh0AgBAIhEAiBQAgEUh5oFmbzOZcGCrgAgUBBIFAQCBQEAgWBQEEgUBAIFAQCBYFAQSBQdATItqveE4FAQSBQEAgUBAIFgUBBIFAQCBQEAgWBQEEgUBAIFAQCBYFA0SpQc7Http+BxxFEIALJCgKBgkCgIBAoCAQKAoGCQKDoCpBbIESgMAQCBYFAQSBQEAgUBAIFgUBBIFAQCBQEAgWBQEEgUBAIFAQChelATx+cN9+CW4+O8/qucSDbNRvo+evAe/he3Fr+fBfdahjIMxro6de7gCZMcqtuh70FWv7yzXv6eBt9FY6g7/zU+ODqCKDGHqwwxUCPbxKg5fXVRoojaJPsCEpu1e2wt0DZbZA3GRAom+ev76MtT3plI1CS8Dgo2Mc7DrdB2qnbgUBVCwKBgkCgIBAoCAQKAoGCQKCwZwRSFgQCBYFAQSBQEAgUBAIFgUBBIFAQCBQEAgWBQEEgUBAIFAQCBYFAsa9AjcX2zP7lhaLUPVAObgTV7UCgqgWBQEEgUBAIFAQCBYFAUT/QqmcdfbkYLy5+t47H66FlnXre4vwm+LA4/2xZJ/edBlr1Lv0/x+PFmQ+zHp4Gf2KgM2F22mmg+fHY86YCqB994X9IgPrRcOou0FSsQYuL0GQefCFWrZvk86rXJxCBZspVbLNWzY9uJKvYxVgFtOod5VbBQwKKN9LCZLORFv9zPTzS3EiPpHu6QwEKdvOfIyAv2s17izPL+ultuJvP++RWMf8+rMtDBRKZF4wAyQ5MChQSHedWxUMAEpsd2VpUCmgajLORYkWr26HBEeR/c7K1SB9IrJbBfm6uGEJ1O+zRazGxhcdL1O2wV0Bw+BDIHCDbNQxIbMHCFG3HOg4kfSXSMlDBhfMVgf6TRx9ILzU7FBamAfnDRxwiikTboGTmheW142wuWe0sUC7JzAvietXlu6avWTUeKLnq+VEwNX7Vs4lA4WoWrWGy6+abnHnBdj0fqM57fDnQ6FScsp2Gu/nMxeDiGvEoNQ+UwsLAEeQPIPFiNzpQTI+gpw+xT8eBxPm1CCg188LyepD8rZodCgsDgdbDS3HKZBSuYsnMCxmfAwZavZWc8chsgxZn/suM+FxQPPPCgyNy+Hux+Y+Sc6kGH0nPGgZaf/rjh31663kXQG4uKaDFq/tR/sXo9iqWeqlhANCsyRE09fdP6rd9Ck9odwJInG+WjA2DT3c0DOSvYf6hsvKt5/Wwy0BT8c3n17HMNgicbD1ooPVv4nvPHwplVzGryxtpeczezRNIURgJNLWs/hT8fkfNDoWFiUCjk3/DMx4EkgIFpzv6xrxxSCB1YSCQNxWrmDhnRiA5kDcXh0Fqn24D6aRmh8KCQKAwDWjzOoMvNQqARKaCBp30qNmhsDAQyLBfoCKQumj8hFlwvll9rUa0ioH9fEOx4w91BQCJ6zTyvwwsOQ4CpxVrHiiFReMjSACtP6mBdFKzQ2GxCyA7l+0R9Gr7VEa3gPA2KHeuh0DZVSz3vgWBMkD5930IlAFSv6vRcSCN46BOAxWEQAQiUL4gELin7gDJf8WsIlClEIhABMoXBAL3RCBwT90Bku/nCSRCIFAQCBQEAgWB1IXtEkhZ7AFQMrGAl/5Xset1KCzMB0omFvC8R+c1gbaTuqh3cvV38yNoZjpQZmKBSKrBiQXszKf2UgyUmVighW3QbB9HEIFSSW2DCCRLMrEAgeSJJxYgUKnU61BYEAgUBAIFgUBBIFAQCBQEAgWBQEEgUBAIFAQCBYFAQSBQEAgUBFIXLoHURQzkVrmnDgDZm0I2hAhEIFgQCBQEAgWBQEEgUOwxUDOxczdaCkcQgQiULw4fyE2AJC/GCEQgVBAIFAQChR0XBAJAst0YgQiECgKBgkDqwk0D5bfSBCIQKAgECgKBIg0k2Up3Hmgz30IElBtCBCKQuiCQunC3gGbbQp0HmhFIVcQDaFPY7pZQ14Fm20CzLSFDgJKJBdJTDOwayLewt4ByQmYAJRMLpKcY2DGQm/ZJgOygMAwouag3c3nvzoDCfznXx7DzS9gh0UbJDKDksvDkVmpigfz08DVF/mxesuyLojOxQGaKgWZOmKkLc0cQgVJpehtUojADKJlYIDPFAIHiJBMLNHkcpFMYAlSQ5hwIVLUgECgIBAoCgcJsoCjl5zJrYIkdTLBGIBACgRAIxNRLEYwJgUAIBEIgEAKBVAJ6cBwxf3LmLIg6y2vHGcQLaqXEvVd7AL1UApoMxMfsu0HKiBO2y3e30YJaKXHv1R5AM1WAnv8Mzk9nz8Qq8yi+08kgWlArJe692gNopgqQP/jFeM6ey8dLfbyNFtRKyXsv/wCaqQIkxrL/s8q+G4QiTmxHC2r9/XL3XuEBNFMWaOI44YZhMtD8GYdLPH14v/la7ydcdgSVfgDNVN7NTwZlthLL6/hZaz7/ctugCg+gmSpAYvQ//3WXfTdImejpRwtqLVLi3qs9gGaqHgdd3ZY5UhGHJ2LrGS2olVLHQVUeQC88kgYhEAiBQAgEQiAQAoEQCIRAIAQCaRtoenTjrXqXLT8LRdoG8kan4j9z0zrQ4vzLxbjtJ6FI60De1Oq3/RRUaR9oZJm8hrUPND/+p2fyEGobaOXrzI8N3gi1DTQ6uffWQ4NXsraBjA+BQAgEQiAQAoEQCIRAIAQCIRAIgUD+B0/MQfuJiClIAAAAAElFTkSuQmCC" /><img src="data:image/png;base64,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" /></p>
</div>
<div id="discrete-distributions" class="section level2">
<h2>Discrete distributions</h2>
<p>The way <code>stat_theodensity()</code> handles discrete
distributions is similar to how it handles continuous distributions. The
main difference is that discrete distributions require whole number or
integer input.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="dv">5</span>), <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="at">mu =</span> <span class="dv">5</span>)),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>incorrect <span class="ot">&lt;-</span> correct</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Change a number to non-integer</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>incorrect<span class="sc">$</span>x[<span class="dv">15</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(incorrect, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: A discrete distribution can not be fitted to continuous data</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A practical difference can be seen above: using simple lines are not
very appropriate for discrete distributions, as they imply a continuity
that is not there.</p>
<p>Instead, one can work with centred steps:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Or perhaps most appropriately, you can display the distributions as
probability masses through lollipops.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(correct, <span class="fu">aes</span>(x, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="at">distri =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">xend =</span> <span class="fu">after_stat</span>(x), <span class="at">yend =</span> <span class="dv">0</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Ignoring unknown aesthetics: xend, yend</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="comparing-different-distributions" class="section level2">
<h2>Comparing different distributions</h2>
<p>Letâ€™s say we are given the task of comparing how well different
distributions fit the same data. While we can use more qualitative
methods, having a look at the distributions is still a useful tool.
Weâ€™ll generate some data and see how it works. Weâ€™ll fit a normal and
Cauchy distribution to the data and plot their densities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="dv">5</span>, <span class="fl">0.2</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAABmFBMVEUAAAAAADoAAGYAOmYAOpAAZrYAv8QEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4QEBASEhIUFBQWFhYYGBgZGRkbGxscHBweHh4fHx8hISEmJiYpKSkqKiouLi4vLy8zMzM0NDQ5OTk6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kJA6kNs/Pz9BQUFGRkZISEhNTU1NTW5NTY5NbqtNjshOTk5QUFBXV1dZWVlhYWFjY2NmAABmADpmAGZmOgBmOpBmZgBmZmZmtrZmtv9sbGxuTU1uTW5uTY5ubm5ubqtuq8huq+R4eHh7e3uGhoaJiYmOTU2OTW6OTY6ObquOyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+VlZWZmZmmpqaqqqqrbk2rbm6rjk2ryKur5P+2ZgC2Zjq2tma225C2/7a2/9u2//+5ubm9vb3Ijk3I///Ozs7T09PbkDrb25Db/7bb///kq27k///l5eXr6+vy8vL4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T///9rcNBXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAN5ElEQVR4nO2diWPcRhXGNyHeQJOWtmm5WyCXuQzYpTUkOG0BE2hKk5jWCVCc2GmJuWI7sSGOjdZn9G+j0a3ZkXbn7ZudkfR9ib2r/XYkvffTjI4ZSx0fsqqO7RVouwDAsgDAsgDAsgDAsgDAsoYFsCup7wP33eGLGs24JABQuEYzLgkAFK7RjEsCAIVrNOOSAEDhGs24JABQuEYzLgkAFK7RjEsCAIVrNOOSAEDhGs24JABQuEYzLgkAFK7RjEuqGQAPALSj4XQ9ANCPhtP1gn/kOQPA6C4AEKLhdAGAEA2j6+0CgH40jC4AUKJhdAGAEg2jG2TfryQAAGZdAKBEw+gCACUaRhcAKNEwugBAiYbRBQBKNHyuyH1rAbggL/3VIKEGKFyjGZcEAArXaMYlAYDCNZpxSQCgcI1mXBIAKFyjGZcEAArXaMYlAYDCNZpxSbUDUNkjAABGXQAgRcPnAgApGj4XAEjR8LkAQIqGzwUAUjR8LgCQouFzAYAUDZvrRS4AaEbD5gIALRo2FwBo0bC5AECLhs2NAVQRAACTLgDQomFzAYAWDZsLALRo2NzWATi4PvOzx8kEPRo2t20AjhYW/e23n8VT9GjY3LYBOLjxzD/648N4ih4Nm9teAOcDjW2FyuVJr83QgCborYfxFH1z4nK9xG1LDRA74Q8/exhP0KPhctsHINDRx8lhED0aLrd1AET7v/1OMkWPhsttHQB/b2YmPQoFAFOqz5lwCqCCAAAYdAGAGA2XCwDEaLhcACBGw+UCADEaLhcAiNFwuQBAjIbLBQBiNFwuABCjYXK9zAUArWiYXACgRsPkAgA1GiYXAKjRMLkAQI2GyQUAajRMLgBQo2FyAYAaDZMLANRomFwAoEbD5AIANRomFwCo0TC5OQDlBADAnNt2ANbllbyvu1ADFK7RjEsCAIVrNOOSAEDhGs24JABQuMOlZP/yEjntmQBA4Q6XknYB8PIuALQTwPGdTmciexUAcm/Fr/3JP3dOPgKAURdblv8J/3BuPnwVP0HCc28jAJcmtLIPAGpXnYKkyemJbTz4FUzn3sYA5gGAYbHqFPTixqV36mmU7QBA9jZ7bQGAUgIAYMx1AEDaBJ1YSpug7C0HgMO5E6Xl6dHwuA4ASPa4ip3w4dxU8Hpi9Bqw2umISgUAJQTKDkP9/Uudzm+ucTRBh3OdzhQAjE/9+wCBoP9kgh4Nj9saAFthlVrta4jo0fC47QAgWrTwTKLXVwXo0fC4rQBwOFd+HYMeDYvrFd3GAijZ/H0AMKZ6Aeh2u/lJvTm7DiDY/cZSXdGjR8PihhkX2fe76aTunF0HkNYApejRsLgRgNDt7loC8D+1GAFUiR4Niysy3o3dCgJ1BhBs/uIUTCjeBzx/MJPes88BAN3U7TYSQL82Fv09V27c6u12Wwcgu2GfGwBybrepAKJmKG6BDm58HjdBDty41fO7uamuldGhYwCwOuFvnXy0FR2GHlxfDO+eG4m+ObG4XrfgdptZA4IKIHoX4hMxp+4d3RoAomsnBnD0iUsAJLeZAI7vTIlOztX4THjDpSZIcl0E0OuU9ifuT5Ze5SzsA/YvdSayvoCjBXce4FADAFui4ejvSNECUCF6NBxutw9AV/EtqwAOr4nu4OM782H/8HyYc/ETHFaeWNqf/JX4bDX4+AcSIQBQuGUAvD5lAHrJti9IBJmPAQgivVP/uTQlvtALfssd7nITlLsU4Q6A3EFP2gQpCVisAb38NeTDdxMAUeMTTxy+//Tv8rCJ4k64fGgpPRoGtw4Acm3LqtiGEwDhx0l1uPvX9+V9RC0uR9cBQLoPEFnMmqBCDfC3ft035KdYA9wEkL/04yyA9CgoTPblJQEk+CjcK0/+MwagGLhV2AcoOyOdBFBCwInzgK1O5wvvzYuXH72bHgVFAI7/1JfgYhPUcXInXBMAQ2j/h30f1eEwtDEAthSDn2sAoND/kgFQEXAcgEpFAEG7Nb+lPJumRzOy2yIAq6f+G12RdglAsQ++0QDCy9Hzrg3MKgWgIAAABtxiF3yjAfhbogkSfTIOAZBGATUbQHguofwDGQBo7ci4EgBqAgDA77YGQHIdwrVLEa0BIBRe0FNflKZHM5orj0YvAOgjUHMALv6BBgA4AMBTua4BiG6UUjH8IfpWn69qghw6D+j7exiHAYjkjQggOg/QvuWNQYVDcpUjcb3MH5MGAJj8x4SfDEQJWOx//72T/777l+C0qheeWmWDVYpy/DB0QA2Qq4DhGtDtUx7Ao9UowavhEBTRJIW39Lg0EQ6IyAarAMBAtwxAdQ0Qo07Eb9EPeS3shTy+uxT+RB32yWAVABjoEgH4W1PxRh5kvQ9AOlilTgD6/yrYaQDHdz8tqwG5wSqNAiARsAwgOhSK9wFFAPGglAYBUFYB2wDCA/n4KEhqgqLBKjUDEGe3FgCoqjuAIgEA4HUBwAkAntoFAJZYq1xFBQAA/WjormMAzKi+AFQEAIDVBYCc6NHQXQDIiR4N2U0yOwBAngAAcLqqCgAA+tGQXQDIix4N1VW2QIWy/QQAgNEFgILo0VBdACiIHg3RTbMKAKHo0RBddQUAAP1oiK4GgIxAswDszdi8YRMAHPz+sb/9TjJFj4boAoCQgBCJHg3NLdkHqwGk324cgKgG2Lhxazros+oWrak3ziGizKoCcHDd3s27h6kB/W1Q42qAtfuGZkeW7QYg7h0aiR4NyS2rACUACrf2Hn2ljGc9p3IA4tb19mtAiwH42zP2HuAwHIC+NqhZAAqiR0NyAUAWPRqKW5r/MgC5B5wwrJTRjEsCAIVrNOOS6g1AboMAgMctPQsoB5A+5IpjpYxmXBIAKFyjGZcEAArXaMYluQigIv8AoB+NvksCEJYCABZXA4BUBQCAxQUAhejRaLtV+a8AIAgAAIerBaBYBQCAwwUAlejR6LqV+a8CEJQEAAYXAJSiR6PpdjN3KACFNggARncBQC16NJpuBkCV/0oAeXgjrZTRjEuqP4B8FQCAkd2sGVHmvxqA8sE+hJUymnFJDQCgGCM64koZzbgkxwBkJ1Pq/A8A4FcRqDeAMSkbZVs1KFdS7qv1G6XbhBqQfbfBNYAejY6bXVIuyf8gAFV7AQAY7BIBpN8GgNHcrF+3LP9lZb3ULScAAANdACgXPZrh3Wx0W2n+SwF4iQsAdDcF4GkD2E0BlBMAgEFuAqAi/+Vz9hIXAKhuOsa/Iv8VALzELSMAAAPcBEBVBaiYsygWASghAADVbvqn8VX5r5pzUNAvzIm8UkYzLskZAGn+6XMGgFHc5A5xIwBIK4+aAABUuWn+R5pzJQEAqHDjHWe6I6XOOSag3A8DQIUbPS3JK3F15qx6sIbuShnNuCQ3AIgt1ssuJ4w053A2qioAAKVulH+2OYtZKQgAQJnb7Xq5g3+OOQezA4Ch3UL6ueYczFNGAAAq1/PkM182tPKcAUB2RfK9vsaar26FTRulbTOacUmWAIS5Vx+ucDZu8dGVl10qHaqo0YxLGjcAz0sTsjvq0eIQbjc9w84vdlBRoxmXVAHgaGHm7WfJxEiJ8DLlXfV1YzPn2Lu5iqdk4R6A5w8WSTdu9fqlKtsd/bL9kG6ypKJZtZJjyXyscgBHHz9W37hVkWE5kuo0hQ8D50zxQDdcYt32AQc3kpv2STdu7X+yuqZMx1QiN9fK0bsmmnDrWwOEGBMBAHkR9gGjJgIA8qo6CvqD+ihoc7hoNqMv5sptbopPVzb90FiJ5rW+vrseOCuBubmysr6+uXzz5u3bt+/fvPDzK9Pfu/3d6ekLV1596bVzb7z4wukvnTn90tkzr7788te/+s2fTL9+4Y3pb09PT38wff+XH1y5f//+ysra+s31leCfWLj4vyJedoMFiGXtJOuzma1ObpVzU2PJfCzCeQAAcIpwJgwAnAIAAACAYQQAhgQANQGQ0474NfihMjvRF3Mf7OyIT9d2zofGWvSlJ0/8J4GzFpg7a2tPnuws37p179695VsXf3F19sf3zs/OXrx67suvv/bmS2e++MLZ0+dfPHvulVe+8bVv/XT2KxffnP3O7OzsR7PLv/3o6vLy8lpQ/taTteCfWLj4vyZe/GAB4SrvpGuWro4c1vhF/TvhUZ7qY6ns2B9ENJQAwLIAwLIcu1VB+wQAlgUAlgUAlgUAlqUL4OB68pDh5w9yjxnTLJu9G7ao6BnKro8XrpTrFQ0WPbM4oMg4pQngaGHR345C2VgMu40pZUVP57ZO2T3BKxsnUxwxo1VULPrgdw81VtuwNAFkHcWix5JaNnynUX7jrb8Fm3HWR1rsLdUquicwbDhUBcgADm58rtkE5eDp1oAwexLAdLyAVlHf94cvOg5RmqAw7wfXF8O4KGW12vBQIovZOJniiBmton7U2e2OCDvhDz976GtuhXLZoBHe09oLM9aAowWX8k85DI1a76NPtAGkZbW24FAH1H2AXDSsuS5JtwkSrXd0/LGh3QSlZWk1IBsnUxwxo1XUtfxr14C9GdF6h1vVguaxfK7s3ozuDjw7mI+XTTkPCN5uzwg5BAFnwpYFAJYFAJYFAJYFAJYFAJYFAJYFAJYFAJblLoCtE0v+4dyU7dUwLXcB+KsT4n/T5TCA/cufTj6yvRLG5TAAf6szb3sVzMtlAKud5rdALgPonfzXXPOrgLsADoPs9042fifgLoDVU0/94zuNb4TcBdASAYBlAYBlAYBlAYBlAYBlAYBlAYBlAYBlAYBl/R9LfUfqW6tQeQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From this it is quite hard to see what distribution more
appropriately fits the data. To get a clearer view, we can use a
histogram instead of a rug plot. The problem though is that by default,
histograms work with count data, whereas densities are integrated to sum
to 1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>There are two possible solutions to this:</p>
<ol style="list-style-type: decimal">
<li>Scale the histogram to densities.</li>
<li>Scale the densities to counts.</li>
</ol>
<p>A nice thing that ggplot2 provides is access to computed variables
with the <code>after_stat()</code> function. Luckily, one of the
computed variables in histograms already is the density.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now we can see that probably the Cauchy distribution fits better than
the normal distribution.</p>
<p>Alternatively, you can also scale the densities to counts. To do
this, we must know the binwidth of the histogram. Since different layers
in ggplot2 donâ€™t communicate, we have to set these manually. Just like
histograms provide the density as computed variable, so too does
<code>stat_theodensity()</code> provide a count computed variable, which
is the density multiplied by the number of observations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>binwidth <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> binwidth) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Normal&quot;</span>), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;norm&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_theodensity</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">*</span> binwidth),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">&quot;Cauchy&quot;</span>), </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">distri =</span> <span class="st">&quot;cauchy&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rolling-kernels" class="section level1">
<h1>Rolling kernels</h1>
<p>A rolling kernel is a method that generates a trend line that doesnâ€™t
require specifying a model, but is also very bad at extrapolating. It is
similar to a rolling window, but data does not need to be equally
spaced. An attempt at illustrating the concept youâ€™ll find below.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For every position on the x-axis, a kernel (above: Gaussian kernel in
blue and green) determines the weight of datapoints based on their
distance on the x-axis to the position being measured. Then, a weighted
mean is calculated that determines the values on the y-axis (red
dots).</p>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>Below is an example for a Gaussian kernel on the <code>mpg</code>
dataset.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is pretty easy to visualise areas of uncertainty by setting the
alpha to scaled weights. This emphasises data-dense areas of the
lines.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(scaled)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="relation-to-kernel-density-estimates" class="section level2">
<h2>Relation to kernel density estimates</h2>
<p>It may seem pretty trivial, but using the weights as the y position
gives something very similar to kernel density estimates. The defaults
for the bandwidth differ slightly, so we exaggerate the similarity by
setting them equal here.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stage</span>(hwy, <span class="at">after_stat =</span> weight),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">linetype =</span> <span class="st">&quot;Rolling</span><span class="sc">\n</span><span class="st">Kernel&quot;</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bw =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="fu">aes</span>(displ, <span class="at">colour =</span> class,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">after_stat</span>(count),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">linetype =</span> <span class="st">&quot;KDE&quot;</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">bw =</span> <span class="fl">0.3</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="rolling-mean" class="section level2">
<h2>Rolling mean</h2>
<p>As a final note on this stat, a rolling mean-equivalent can be
calculated using the <code>&quot;mean&quot;</code> kernel. This is the same as
setting the kernel to <code>&quot;unif&quot;</code>, since it uses the uniform
distribution as kernel. Typically, this is a bit more blocky than using
Gaussian kernels.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rollingkernel</span>(<span class="at">kernel =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">bw =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="difference" class="section level1">
<h1>Difference</h1>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Many people who try to illustrate the difference between two lines
might have run into the following problem. In the example below we want
to illustrate the difference between the <code>uempmed</code> and
<code>psavert</code> variables from the <code>economics</code> dataset,
and change the colour of a ribbon depending on which of the variables is
larger. Because the groups are inferred from the fill colour, and there
are small islands where <code>uempmed &gt; psavert</code> is true, the
ribbon will be drawn in an overlapping way. This makes perfect sense for
many visualisations, but is an inconvenience when we just want to plot
the difference.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(economics, <span class="fu">aes</span>(date))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmin</span>(psavert, uempmed), </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> <span class="fu">pmax</span>(psavert, uempmed),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> uempmed <span class="sc">&gt;</span> psavert),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To circumvent this inconvenience, <code>stat_difference()</code> uses
run-length encoding to re-assign the groups and adds a <code>sign</code>
variable to keep track which of the two variables is larger. By default,
the <code>fill</code> is populated with the <code>sign</code>
variable.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> psavert, <span class="at">ymax =</span> uempmed),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha  =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAEgCAMAAACKBVRjAAAAz1BMVEUAAAAAADoAAGYAOpAAZrYvxFwwxV0zMzMzyGA6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmtv9uTU1uTW5uTY5ubqtuq8huq+R+rfyOTU2OTW6OTY6OyP+QOgCQkGaQtpCQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC22/+2///Ijk3I///bkDrb///kq27k///r6+vy8vL1jYb3j4j5kYr/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8oGkGxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANs0lEQVR4nO2dC3ucuBWGx17T2Ek9ubh1sqnrxN5tnKxTXxKrqi+tPR7+/29aBOKiGwhGcBjmO89jMzMfBzTn5UgChGYWw0htRl2ATTcAIDYAIDYAIDYAIDYAILY6AMxtNZpb6uQ0EklTAGBoCQCIJQAglgCAWAIAYgkAiCUAIJYAgFjqH8Dj+/n8JI5/zufzN1cA0KCEB7D4dB4/fjiPL09KzV1QAAgO4P5d8u/yZPn1HAA8lPAAhCVZsDiepzVRHL948SLcXmBOqwBYnh2ltVCRBe4jBRnQA4DF8ZF8lbcD7oICQHgAj++L5hcAGpXwAGT879/exMtv6IY2KeEBiP6/aH6T5eu8I+QuKAAEB2Azd0EBAAAGlgCAWAIAYgkAiCUAIJYAgFgCAGIJAIglACCWAIBYAgBiCQCIJQAglgCAWAIAYgkAiCUAIJZIAMAGMGSAn4QqaBiJpwvOm5wAoCcpCz0AkEkAQCwBALEEAMQSABBLAEAsAQCxBADEEgAQSwBALInQcwCgk3gafQAgk9LocwAgkwCAWMoBGAgAYBgJAGilW0IAcrqaxfH87c0mA+BEAOR0Ncuzk/jnOwAYHoCcrmbx+Sp+/HVjn5QnBCAsyYLHjzdpMmzmdDW3FRtqn9p0NWKuiAxAvIEZwKsZoObAABmQTldTZgAAKAiG6AWJ6VI2uw2gBCCnqxHV0Ob2gigB5NPVbPR5AGkVZDH3dwAAAOhDAgBiqQqAA8DwEgDQShwAaCUAIJYAgFgCAGIJAIglDQAHgIElACCWggF4ePkFADpIyABiCQCIpdUBPOzNZrPDtAp6Opht/f7q4uHl73viIwDwkFYGkNb9D3uHyfLpYD9hsH3xsPfLj/h6+wIAPKTVAby6yEHciZhfCwCH9Y0yZksp7dawtlv4PpvtxGnAr5MDXwDJkqIjAPdBtCEZwJ1OzpglVf/2BQDQARAIDvMq6G6bBEDUxWkMkgmAu5zsAUujnkS72ggDgK/EHQC4zckRsbukF7r1peiG/gYALSQrAN4OgM5DNAQNBgC5hQVwlyTC8+lOMyQAyC1wBlzPsi4pAPhKPVRBPgYAuQEAsQQAxJIDAAeAgSQR7hUB/MduAOAl2QHwNgD+azUA8JMAgFgCAGIJAIglACCW3AC46QQA4SUAIJacAPhQANIHtMXjqm9We1AbALoBuE8Df3mCDKABcPn6jyQDll/PAaA3AE9/NwdoaVXQ4jh9Xj5eZbqa3Y5+xGaOCmo9PCgAgMcP52UWuA8iZEAHAOKO/Wy2Xw8gtbwdcH8HAOgrAwCAGICYMWv5zbsbaos1AHTrBZXnAa/zjpD7O1gByDcA0BWAYe7vAACjBJC9AwAA6CQBALE0FQARAABAJykAgOGHpWwIAO4J4C9WGwJAFnoAGBZAVLS70wfAxwcgsgOIAGA4ABEAEAMQlr6VbxgA0ACIyjcpAAeCcoPGCqMHcKttYwQAog0CwNcFQOQNIHJJvvEKLk0GwC4A9AJAjVgtgKgZgL4KADSaPthkN7fq6924+Kx+Y2JN3z0PZDXDUnyHppBkQNb3jFplQLbmagdscGmEGaDsUgMQrQogGhkA3juA79ZH59sAqMSsCYAVQb7B0pHrUohQdpP6B2C3wAAiAACAbtL4AUQtANhbgbUDwCoAtF82JAYQAQABgEpYZZStthspq1q+uQEgAgBPAMXF54AAIgBoDSDyAKDcLla/uQYgGgZAQ3U3PQBFulSCkn06WQC9DksJDyACgOEARNk3twOIpgLgn1ajBZAvsm8OAEMDKDmwAkC5agEgAoA+AUQKgIoBAAAU6roAkFFtByACgFAAojYAZH3vBhANDMA695JURwAgfUpycTx/exMcQDSODCAG8HQwM6dT12ZLWZ6dxD/fBQNQUhgDAPvsY1LtH8Dz6WF8veMEkM2Wsvh8VT4xr+xSjWcbAAW42PioALAbKMo1UhpRhxcfAoB4Tj7/nSVbBmSTdXy8iRefxJPa+mwpuyuaZRtiKEhckT2s+1iW2sElt/ZBKcqnHvuoB/Dw1x/x09/039KwTFWQAYhdGVB3mNdJjOmKOCrldj0zQLvK3SYD8oOaLgPE72k0AigzYBAAbCwA+AAAvDLAow3oDEBXWGsA0VoD8GoDlmdHDb2gzgAMJf3mueQTytxpTQE8n+7X9YJ8zwPCAsg3u+saUR0CAGdlKJOXVACazgNM6xUAowKgP200HACr9QDAuOBQB6BoA7IzvL4AVGNq1k4AUACwELADcFUmTQC4MchtigAcCABgMAB2Ag0AIgNAZAHAVwfAK0q2LQDoAIBbm1MrANX6AzDAqAgqAMUIVHHqtjKAIph1ANLr1+0AdLE+ABhrWwEoG94trlpXEWQA0oEULG8CeBQEgAy9GmUAyO+dyT5puqgCSGNmAFBj4wWAFwC4AwDbdACRBiAqAJQx9QOgxT+Pcg7AIk0EgEHBDiC/wWMCSNeyA5AZwOXLTgD0w39SALIaxA8AswEo1ioARPn107T+yAHIEDKmUSgLr8cfAPT4K/eYWTGaJbc4/dQK4FYBoITIE4BdAgDdiylOPD9yb4sYlnd8AwHQfQHADqCIVxcApk0OgOrVHYDqYwFQCRoAVFz6AVA0nvFwAOJNAhA1AWAbAkCxdiOApIvpZR8HpOixxU3zuc1G8uijeawFd84/UyvovrH3Tym1tD4zQL8xkM2jYmYAUwdM+GUAMzOAV9ZYIQMqDXqeDcZlp7UGYN5aZB2qIBuAaoSc8a+ZEGIaAGKnVzGTkHnjqwRg3E8jAMAUAOr21hxA/qkBIL/8k/znke6Vhd8AwAwA5SqrAVCc1xqA4lcC0ONfAGD+ANJbko0AXFF2ANCuaEwVgGkxi3IuTgDVwGRHqQkgMp7CMILMagGwyQFgilMtANYegDbqKr1eXUgBAOR7GjMA/ZKPcZ/QD0DlW9t2xeoAVAZ+dgfAuDlihTMjo0YFIG82AwOwnT/rAFQvGT8DAJ8+AHMIRE8AjMAoXlzpOmoAVAhWAGwtATDZcgYHoFxFsgEwvUoAbMMAGFIQAKwtgMqt+cAALLuaPgA2OAC2zgDUqwehALDqrjwAlP6iY3TLy1E/ACCrdK+nMOwAmr0q/g4ArBZA6jdRAKwLgGKrrQGkgb6VPdByCEUXAM5djQKAXbVGJbvE7PksannYWXfljkqxAZ6PP8wBZH3TZgDuwaZrDoB1BcACAaick00WgBzZ5vwSEWsNgEkAnlEpNqADyLfqAsDkQNExAPg5n4tZUzoCYLUAfEeTqxsOBCAT2OgBXJ6Ur5VdGgCYJvcHwDcqxQZ4ftGfrR2A5ddzTwBaAcsB5aEBuH8asQsANnIAi+OkCkqToGm6Gm07u8U/l3nPNKMMAOnyc0vKYBJlsMqtfWaabJd9DTypNw3A44fzMgsU5g0Z0HhYdsyAut8nrs0AeRFCvcHC6jKgpuwD94LydkANhHK21QFAnVIDwNerary4tzVdAO2jMiCAbBxPCwDN+xoKgJgxa/nN2g1VzrYAoCcA4jzgdd4R0gtReXCoS1S6OXUHUPRtVGnkAKpmKUckR1WNHUDldrEhAkD/ki8AtnYAGNMncGgqqpfSo+QAwNYXgPdXD+PUPwD3bRf3rgDAW3IBYMU9AgDoVQKAFZ36BMAAoH/JDaDQAWB4AOU7ABhe4vrlCQ8vAAgoAQCxBADUEgAQSwBALAEAsQQAxJIr/mMDMFmjGYBiN2SAnxeqoJASAKyfBADEEgAQSwBALAEAsQQAxBIAEEsAQCwBALEEAMQSABBLJABq7EXzKoGc1sBrJQOA1b1WMgBY3WslA4DVvVayjbwjNiYDAGIDAGIDAGIDAGJrA+Dx16vk33sxoZOY10lMq7I4nr+98XXKF81OnbyS9cREL3I9deHrJffsUcJQ1gLAvYjD4vgk/pkV7v7tzfIseffO12nx6Vwsmp1Ur2zR6CW2/vjhXK6nLny95J49ShjM/AFcvv4jOTgeP96khc6Kvvh8lR0yXk7p4vNVo5PF69N5o9e9iNjliVxPXfh6yT03lzCcta2CSgDiECnf+TjJDPBwqnqpi/oSGqu39DK+ZP/WFkBaIYjpPNICislVPADkTlnV6uFU9ZILH6/l2VG+dXXh6yX37OMVyro0wv/4KmPvmwHSSUzHdf/myjcD8l1J52avxfFR3D5vql7x+DNAmKgi48sj+aqhsqw4yQPLp4ZVdhX7tRyP70/KIvm2AaqX3POY24C0Hn+XT68osrehu1Bxkhng4VT1kotGryyS+XrqwtdL7tmnhKGsdQbcz7P+dZahnucB0uk+mw3K9zyg9PLp0WunJp7nAcYJzYjPA2B9GAAQGwAQGwAQGwAQGwAQ2+gB3G1fFK//92/CgvRk6wTg4eUXypL0YwBAbKMG8HQw2/otAfCwN5vN9sX//fj5dDar1Eprb2MG8HSwn/xtXzwdHMbx9faFyIDn053k9S8/qMsWzMYMIK19ksD/X4Q7ib4AkH6WEpmIjRlAeqA/vEoifpdUQVspgOtZavvUZQtm6wDg6WDrS54BU6p9UhszgLS6Sf7diaDfZRmQLKiLFdbGDODpYCdthEXQH/a2voiq//k0oTElCmMGUHRDvyctwL+S6H+f7aTd0AnFf9wANsEAgNgAgNgAgNgAgNgAgNgAgNgAgNgAgNgAgNj+BNwv9/Oq3qXpAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="controlling-the-fill" class="section level2">
<h2>Controlling the fill</h2>
<p>Because there are 4 dates in the dataset where
<code>uempmed == psavert</code> is true, <code>stat_difference()</code>
will include a <code>0</code> level. The ribbon has no height where this
occurs, so you donâ€™t typically see this zero-difference level. The
<code>levels</code> argument is included to assert more control over how
the <code>sign</code> computed variable will be displayed. In the
example below, we remove the <code>0</code> level by giving it a
<code>NA</code> for sign and telling the fill scale to not translate
<code>NA</code>s.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> psavert, <span class="at">ymax =</span> uempmed),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;More uempmed&quot;</span>, <span class="st">&quot;More psavert&quot;</span>, <span class="cn">NA</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha  =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">na.translate =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="interpolation" class="section level2">
<h2>Interpolation</h2>
<p>An additional nicety of <code>stat_difference()</code> is that it
interpolates the cross-over points of lines. Itâ€™s not very visible in
the densely populated graph above, but we can generate some dummy data
to show what we mean.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">2.5</span>), <span class="at">ymax =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymin)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ymax))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ymax <span class="sc">&lt;</span> ymin)) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Plain ribbon&quot;</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">stat_difference</span>() <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;stat_difference()&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
</div>
</div>
<div id="function-x-y" class="section level1">
<h1>Function X, Y</h1>
<p>Sometimes, you just want to calculate a simple function on the x- and
y-positions of your data by group. That is where
<code>stat_funxy()</code> comes in. It takes two functions as arguments,
one to be applied to the x-coordinates and one to be applied to the
y-coordinates. The primary limitation of this stat is that you cannot
use functions that are supposed to work on the x- and y-positions
simultaneously.</p>
<p>For example, it is pretty easy to combine <code>range</code> and
<code>mean</code> to construct range indicators.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> faithful</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>eruptions <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Low&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_funxy</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">funx =</span> range, <span class="at">funy =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">&quot;both&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="centroids-and-midpoints" class="section level2">
<h2>Centroids and midpoints</h2>
<p>There are also two variations on <code>stat_funxy()</code> and that
are <code>stat_centroid()</code> and <code>stat_midpoint()</code>. While
the default function arguments in <code>stat_funxy()</code> do nothing,
the default for <code>stat_centroid()</code> is to take the means of x-
and y-positions and <code>stat_midpoint()</code> takes the mean of the
range. Under the hood, these are still <code>stat_funxy()</code>, but
have default functions. The centroid and midpoint stats are convenient
to label groups, for example.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Centroid&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_midpoint</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="st">&quot;Midpoint&quot;</span>), <span class="at">colour =</span> <span class="st">&quot;limegreen&quot;</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;label&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cropping-data" class="section level2">
<h2>Cropping data</h2>
<p>While for the general case the data should be cropped to the lengths
of the function outputs, you can change this behaviour by setting
<code>crop_other = FALSE</code>. This might be convenient when you might
have other aesthetics that you care about, in the same group. Not
cropping other data probably only makes sense if the functions you
provide return a single summary statistic though.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(waiting, eruptions, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="fu">aes</span>(<span class="at">xend =</span> waiting, <span class="at">yend =</span> eruptions, <span class="at">colour =</span> group),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="at">crop_other =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="run-length-encoding" class="section level1">
<h1>Run length encoding</h1>
<p>Run length encoding (RLE) is useful as a data compression mechanism,
but can also be useful in plotting to check if subsequent conditions are
being fulfilled. The default behaviour of <code>stat_rle()</code> is to
draw rectangles in the regions where a series of values (a run) have the
same value. Letâ€™s say I have the following series:</p>
<blockquote>
<p>A-A-A-A-B-B-B-C-C-D</p>
</blockquote>
<p>This series can be compacted by run length encoding, but can also be
useful to extract the following properties:</p>
<table>
<thead>
<tr class="header">
<th align="right">run_id</th>
<th align="left">run_value</th>
<th align="right">run_length</th>
<th align="right">start_id</th>
<th align="right">end_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div id="examples-1" class="section level2">
<h2>Examples</h2>
<p>In the example below, weâ€™ll use the <code>cut()</code> function to
divide the y-values into three bins, and use the <code>stat_rle()</code>
to draw rectangles where datapoints fall into these bins.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">cos</span>(df<span class="sc">$</span>x)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This can be made slightly more pleasing by closing gaps between
rectangles.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>)),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">align =</span> <span class="st">&quot;center&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="using-computed-variables" class="section level2">
<h2>Using computed variables</h2>
<p>An alternative use case of <code>stat_rle()</code> is to use the
computed variables to describe a series of data. For example, if weâ€™d
like to summarise the above graph in just itâ€™s runs, we might be
interested in what order the runs are and how long the runs are. If we
make use of ggplot2â€™s <code>after_stat()</code> and <code>stage()</code>
functions, we can grab this information from the stat.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_rle</span>(<span class="fu">aes</span>(<span class="fu">stage</span>(x, <span class="at">after_stat =</span> run_id),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">after_stat</span>(runlength),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="fu">cut</span>(y, <span class="at">breaks =</span> <span class="dv">3</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">after_stat</span>(runvalue)),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">geom =</span> <span class="st">&quot;col&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
